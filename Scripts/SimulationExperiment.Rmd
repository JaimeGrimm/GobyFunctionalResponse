# Simulation Experiment

Here, we will (1) simulate FR data, (2) fit FR models to the simulated data, and (3) select the "best fit" model using:

1.  Juliano's
2.  A generalized FR model w/ scaling exponent
3.  Visual inspection
4.  AIC

Empirically, Grimm et al. conducted three experiments, within which three, three, and two treatments we applied, resulting in eight data sets. From here, Rogers' Type II and Hassell's Type III functional response models were fit to the data. We will use estimated parameter values from each experiment and treatment to simulate each of these two models, 1000 times.

Rogers' Type II FR:

$$
N_e=N_0(1-exp^{a(N_eh-T)})
$$

Where $N_e$ is the number of prey eaten, $N_0$â€‹ is the initial number of prey, and $a$, $h$, and $T$ are the attack rate, handling time and the total time available, respectively.

Hassell's Type III FR:

$$
N_e=N_0(1-exp^{bN_0\frac{N_eh-T}{1+cN_0}})
$$

Where $b$, and $c$ are free parameters.

## Set-Up

```{r echo = TRUE, results = 'hide'}
library(frair); library(lamW); library(tidyverse); library(here)
```

Per the `FRAIR` package, "The fact that $N_e$ appears on both side of the equation [for Rogers' Type II functional response], poses some problems, but can be efficiently dealt with using Lambert's transcendental equation (Bolker, 2008). `FRAIR` uses the `lambertW0` function from the `lamW` package and uses this function internally as:

`Ne <- X - lambertW0(a * h * X * exp(-a * (T - h * X)))/(a * h)`

where $X = N_0$." To write Hassell's Type III functional response, we replace `a` with `(b*X)/(1 + c*X)`.

```{r}
## Rogers' Type II Model
RogersII <- function(N0, a, h, time){
  N0 - lamW::lambertW0(a * h * N0 * exp(-a * (time - h * N0)))/(a * h)
}

## Hassell's Type III Model
HassellIII <- function(N0, b, c, h, time){
  a <- b*N0/(1 + c*N0)
  N0 - lamW::lambertW0(a * h * N0 * exp(-a * (time - h * N0)))/(a * h)
}

# Test
N0s <- seq(1, 150, 1)
Ne <- c()
for (i in 1:length(N0s)){
  Ne[i] <- RogersII(N0s[i], 0.2, 0.2, 2)
}
plot(N0s, Ne, main = "Rogers' Type II Functional Response")

N0s <- seq(1, 150, 1)
Ne <- c()
for (i in 1:length(N0s)){
  Ne[i] <- HassellIII(N0s[i], 0.1, 0.1, 0.02, 2)
}
plot(N0s, Ne, main = "Hassell's Type III Functional Response")
```

[Parameter Estimates by Experiment and Treatment](https://docs.google.com/spreadsheets/d/1oGCKVAigW9UiNIdo2o0YO_gVQ8yaCcvXJf1FVvYEjuM/edit?gid=0#gid=0):

| Treatment     | Model             | Parameter | Lower CI | Point Estimate | Upper CI          |
|------------|------------|------------|------------|------------|------------|
| Ex. 1, Low    | Rogers, Type II   | *a*       | 0.489    | 1.704          | 3.598             |
|               |                   | *h*       | 0.055    | 0.072          | 0.094             |
| Ex. 1, Medium | Rogers, Type II   | *a*       | 0.706    | 1.036          | 1.458             |
|               |                   | *h*       | 0.033    | 0.046          | 0.059             |
|               | Hassell, Type III | *b*       | 0.218    | 5.303          | **1,686,863.823** |
|               |                   | *c*       | 0.049    | 5.000          | **1,796,176.396** |
|               |                   | *h*       | 0.033    | 0.046          | 0.060             |
| Ex. 1, High   | Rogers, Type II   | *a*       | 0.224    | 0.607          | 1.055             |
|               |                   | *h*       | 0.028    | 0.055          | 0.091             |
|               | Hassell, Type III | *b*       | 0.079    | 0.537          | **1,072,285.537** |
|               |                   | *c*       | 0.000    | 0.758          | **2,227,240.993** |
|               |                   | *h*       | 0.008    | 0.058          | 0.088             |
| Ex. 2, Low    | Rogers, Type II   | *a*       | 0.262    | 0.477          | 0.752             |
|               |                   | *h*       | 0        | 0.038          | 0.132             |
|               | Hassell, Type III | *b*       | 0.062    | 0.191          | **197,962.248**   |
|               |                   | *c*       | 0.000    | 0.239          | **533,631.835**   |
|               |                   | *h*       | 0.000    | 0.061          | 0.143             |
| Ex. 2, Medium | Hassell, Type III | *b*       | 0.013    | 0.039          | **323,804.821**   |
|               |                   | *c*       | 0.000    | 0.180          | **3,514,096.291** |
|               |                   | *h*       | 0.000    | 0.067          | 0.274             |
| Ex. 2, High   | Rogers, Type II   | *a*       | 0.086    | 0.144          | 0.207             |
|               |                   | *h*       | 0.000    | 0.046          | 0.257             |
|               | Hassell, Type III | *b*       | 0.010    | 0.024          | 0.068             |
|               |                   | *c*       | 0.000    | 0.026          | 2.007             |
|               |                   | *h*       | 0.000    | 0.181          | 0.420             |
| Ex. 3, Rocks  | Rogers, Type II   | *a*       | 0.075    | 0.131          | 0.211             |
|               |                   | *h*       | 0.000    | 0.102          | 0.293             |
| Ex. 3, Sand   | Rogers, Type II   | *a*       | 0.488    | 0.848          | 1.516             |
|               |                   | *h*       | 0.000    | 0.048          | 0.249             |
|               | Hassell, Type III | *b*       | 0.221    | 1.181          | **3,338,468.210** |
|               |                   | *c*       | 0.000    | 1.163          | **1,780,576.771** |
|               |                   | *h*       | 0.000    | 0.058          | 0.289             |

## Simulations

### Experiment #1

#### Treatment: Low

##### Rogers' Type II FR Model

```{r}
# Initial Densities

N0 <- c(4, 6, 10, 20, 60, 90, 120)

# Simulations

set.seed(123)
a.vec <- sample(seq(0.489, 3.598, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.055, 0.094, 0.001), 1000, replace = TRUE)
Ex1.TLow.II.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex1.TLow.II.Unif[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

set.seed(123)
a.vec <- rlnorm(1000, mean = log(1.704), sd = log(2)) 
h.vec <- rlnorm(1000, mean = log(0.072), sd = log(2)) 
Ex1.TLow.II.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex1.TLow.II.Norm[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 1, Low Treatment: Rogers' Type II FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 120), ylim = c(0, 50))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex1.TLow.II.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 1, Low Treatment: Rogers' Type II FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 120), ylim = c(0, 150))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex1.TLow.II.Norm[[i]][j])
  }
}
```

##### Hassell's Type III FR Model

[***NA***]{.underline}

#### Treatment: Medium

##### Rogers' Type II FR Model

```{r}
# Initial Densities

N0 <- c(4, 6, 10, 20, 60, 90, 120)

# Simulations

set.seed(123)
a.vec <- sample(seq(0.706, 1.458, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.033, 0.059, 0.001), 1000, replace = TRUE)
Ex1.TMed.II.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex1.TMed.II.Unif[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

set.seed(123)
a.vec <- rlnorm(1000, mean = log(1.036), sd = log(2)) 
h.vec <- rlnorm(1000, mean = log(0.046), sd = log(2)) 
Ex1.TMed.II.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex1.TMed.II.Norm[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 1, Medium Treatment: Rogers' Type II FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 120), ylim = c(0, 50))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex1.TMed.II.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 1, Medium Treatment: Rogers' Type II FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 120), ylim = c(0, 150))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex1.TMed.II.Norm[[i]][j])
  }
}
```

##### Hassell's Type III FR Model

```{r}
# Initial Densities

N0 <- c(4, 6, 10, 20, 60, 90, 120)

# Simulations

set.seed(123)
b.vec <- sample(seq(0.218, 1686863.823/100000, 0.001), 1000, replace = TRUE) 
c.vec <- sample(seq(0.049, 1796176.396/100000, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.033, 0.060, 0.001), 1000, replace = TRUE)
Ex1.TMed.III.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex1.TMed.III.Unif[[i]][j] <- round(HassellIII(N0[i], b.vec[j], c.vec[j], h.vec[j], 2))
  }
}

set.seed(123)
b.vec <- rlnorm(1000, mean = log(5.303), sd = log(2))
c.vec <- rlnorm(1000, mean = log(5.000), sd = log(2))
h.vec <- rlnorm(1000, mean = log(0.046), sd = log(2))
Ex1.TMed.III.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex1.TMed.III.Norm[[i]][j] <- round(HassellIII(N0[i], b.vec[j], c.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 1, Medium Treatment: Hassell's Type III FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 120), ylim = c(0, 80))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex1.TMed.III.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 1, Medium Treatment: Hassell's Type III FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 120), ylim = c(0, 150))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex1.TMed.III.Norm[[i]][j])
  }
}
```

#### Treatment: High

##### Rogers' Type II FR Model

```{r}
# Initial Densities

N0 <- c(4, 6, 10, 20, 60, 90, 120)

# Simulations

set.seed(123)
a.vec <- sample(seq(0.224, 1.055, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.028, 0.091, 0.001), 1000, replace = TRUE)
Ex1.THigh.II.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex1.THigh.II.Unif[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

set.seed(123)
a.vec <- rlnorm(1000, mean = log(0.607), sd = log(2)) 
h.vec <- rlnorm(1000, mean = log(0.055), sd = log(2)) 
Ex1.THigh.II.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex1.THigh.II.Norm[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 1, High Treatment: Rogers' Type II FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 120), ylim = c(0, 60))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex1.THigh.II.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 1, High Treatment: Rogers' Type II FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 120), ylim = c(0, 100))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex1.THigh.II.Norm[[i]][j])
  }
}
```

##### Hassell's Type III FR Model

```{r}
# Initial Densities

N0 <- c(4, 6, 10, 20, 60, 90, 120)

# Simulations

set.seed(123)
b.vec <- sample(seq(0.079, 1072285.537/1000000, 0.001), 1000, replace = TRUE) 
c.vec <- sample(seq(0.000, 2227240.993/1000000, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.008, 0.088, 0.001), 1000, replace = TRUE)
Ex1.THigh.III.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex1.THigh.III.Unif[[i]][j] <- round(HassellIII(N0[i], b.vec[j], c.vec[j], h.vec[j], 2))
  }
}

set.seed(123)
b.vec <- rlnorm(1000, mean = log(0.537), sd = log(2))
c.vec <- rlnorm(1000, mean = log(0.758), sd = log(2))
h.vec <- rlnorm(1000, mean = log(0.058), sd = log(2))
Ex1.THigh.III.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex1.THigh.III.Norm[[i]][j] <- round(HassellIII(N0[i], b.vec[j], c.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 1, High Treatment: Hassell's Type III FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 120), ylim = c(0, 150))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex1.THigh.III.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 1, High Treatment: Hassell's Type III FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 120), ylim = c(0, 150))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex1.THigh.III.Norm[[i]][j])
  }
}
```

### Experiment #2

#### Treatment: Low

##### Rogers' Type II FR Model

```{r}
# Initial Densities

N0 <- c(2, 3, 5, 10, 20, 30, 50)

# Simulations

set.seed(123)
a.vec <- sample(seq(0.262, 0.752, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.000, 0.132, 0.001), 1000, replace = TRUE)
Ex2.TLow.II.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex2.TLow.II.Unif[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

set.seed(123)
a.vec <- rlnorm(1000, mean = log(0.477), sd = log(2)) 
h.vec <- rlnorm(1000, mean = log(0.038), sd = log(2)) 
Ex2.TLow.II.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex2.TLow.II.Norm[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 2, Low Treatment: Rogers' Type II FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 50), ylim = c(0, 50))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex2.TLow.II.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 2, Low Treatment: Rogers' Type II FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 50), ylim = c(0, 50))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex2.TLow.II.Norm[[i]][j])
  }
}
```

##### Hassell's Type III FR Model

```{r}
# Initial Densities

N0 <- c(2, 3, 5, 10, 20, 30, 50)

# Simulations

b.vec <- sample(seq(0.062, 197962.248/100000, 0.001), 1000, replace = TRUE) 
c.vec <- sample(seq(0.000, 533631.835/100000, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.000, 0.143, 0.001), 1000, replace = TRUE)
Ex2.TLow.III.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex2.TLow.III.Unif[[i]][j] <- round(HassellIII(N0[i], b.vec[j], c.vec[j], h.vec[j], 2))
  }
}

b.vec <- rlnorm(1000, mean = log(0.191), sd = log(2))
c.vec <- rlnorm(1000, mean = log(0.239), sd = log(2))
h.vec <- rlnorm(1000, mean = log(0.061), sd = log(2))
Ex2.TLow.III.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex2.TLow.III.Norm[[i]][j] <- round(HassellIII(N0[i], b.vec[j], c.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 2, Low Treatment: Hassell's Type III FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 50), ylim = c(0, 60))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex2.TLow.III.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 2, Low Treatment: Hassell's Type III FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 50), ylim = c(0, 60))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex2.TLow.III.Norm[[i]][j])
  }
}
```

#### Treatment: Medium

##### Rogers' Type II FR Model

[***NA***]{.underline}

##### Hassell's Type III FR Model

```{r}
# Initial Densities

N0 <- c(2, 3, 5, 10, 20, 30, 50)

# Simulations

b.vec <- sample(seq(0.013, 323804.821/100000, 0.001), 1000, replace = TRUE) 
c.vec <- sample(seq(0.000, 3514096.291/100000, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.000, 0.274, 0.001), 1000, replace = TRUE)
Ex2.TMed.III.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex2.TMed.III.Unif[[i]][j] <- round(HassellIII(N0[i], b.vec[j], c.vec[j], h.vec[j], 2))
  }
}

b.vec <- rlnorm(1000, mean = log(0.039), sd = log(2))
c.vec <- rlnorm(1000, mean = log(0.180), sd = log(2))
h.vec <- rlnorm(1000, mean = log(0.067), sd = log(2))
Ex2.TMed.III.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex2.TMed.III.Norm[[i]][j] <- round(HassellIII(N0[i], b.vec[j], c.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 2, Medium Treatment: Hassell's Type III FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 50), ylim = c(0, 60))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex2.TMed.III.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 2, Medium Treatment: Hassell's Type III FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 50), ylim = c(0, 60))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex2.TMed.III.Norm[[i]][j])
  }
}
```

#### Treatment: High

##### Rogers' Type II FR Model

```{r}
# Initial Densities

N0 <- c(2, 3, 5, 10, 20, 30, 50)

# Simulations

a.vec <- sample(seq(0.086, 0.207, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.000, 0.257, 0.001), 1000, replace = TRUE)
Ex2.THigh.II.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex2.THigh.II.Unif[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

a.vec <- rlnorm(1000, mean = log(0.144), sd = log(2)) 
h.vec <- rlnorm(1000, mean = log(0.046), sd = log(2)) 
Ex2.THigh.II.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex2.THigh.II.Norm[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 2, High Treatment: Rogers' Type II FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 50), ylim = c(0, 20))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex2.THigh.II.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 2, High Treatment: Rogers' Type II FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 50), ylim = c(0, 50))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex2.THigh.II.Norm[[i]][j])
  }
}
```

##### Hassell's Type III FR Model

```{r}
# Initial Densities

N0 <- c(2, 3, 5, 10, 20, 30, 50)

# Simulations

b.vec <- sample(seq(0.010, 0.068, 0.001), 1000, replace = TRUE) 
c.vec <- sample(seq(0.000, 2.007, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.000, 0.420, 0.001), 1000, replace = TRUE)
Ex2.THigh.III.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex2.THigh.III.Unif[[i]][j] <- round(HassellIII(N0[i], b.vec[j], c.vec[j], h.vec[j], 2))
  }
}

b.vec <- rlnorm(1000, mean = log(0.024), sd = log(2))
c.vec <- rlnorm(1000, mean = log(0.026), sd = log(2))
h.vec <- rlnorm(1000, mean = log(0.181), sd = log(2))
Ex2.THigh.III.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex2.THigh.III.Norm[[i]][j] <- round(HassellIII(N0[i], b.vec[j], c.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 2, High Treatment: Hassell's Type III FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 50), ylim = c(0, 45))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex2.THigh.III.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 2, High Treatment: Hassell's Type III FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 50), ylim = c(0, 45))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex2.THigh.III.Norm[[i]][j])
  }
}
```

### Experiment #3

#### Treatment: Rocks

##### Rogers' Type II FR Model

```{r}
# Initial Densities

N0 <- c(2, 3, 5, 10, 20, 30)

# Simulations

a.vec <- sample(seq(0.075, 0.211, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.000, 0.293, 0.001), 1000, replace = TRUE)
Ex3.TRocks.II.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex3.TRocks.II.Unif[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

a.vec <- rlnorm(1000, mean = log(0.131), sd = log(2)) 
h.vec <- rlnorm(1000, mean = log(0.102), sd = log(2)) 
Ex3.TRocks.II.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex3.TRocks.II.Norm[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 3, Rocks Treatment: Rogers' Type II FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 30), ylim = c(0, 20))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex3.TRocks.II.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 3, Rocks Treatment: Rogers' Type II FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 30), ylim = c(0, 20))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex3.TRocks.II.Norm[[i]][j])
  }
}
```

##### Hassell's Type III FR Model

[***NA***]{.underline}

#### Treatment: Sand

##### Rogers' Type II FR Model

```{r}
# Initial Densities

N0 <- c(2, 3, 5, 10, 20, 30)

# Simulations

a.vec <- sample(seq(0.488, 1.516, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.000, 0.249, 0.001), 1000, replace = TRUE)
Ex3.TSand.II.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex3.TSand.II.Unif[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

a.vec <- rlnorm(1000, mean = log(0.848), sd = log(2)) 
h.vec <- rlnorm(1000, mean = log(0.048), sd = log(2)) 
Ex3.TSand.II.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex3.TSand.II.Norm[[i]][j] <- round(RogersII(N0[i], a.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 3, Sand Treatment: Rogers' Type II FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 30), ylim = c(0, 35))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex3.TSand.II.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 3, Sand Treatment: Rogers' Type II FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 30), ylim = c(0, 35))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex3.TSand.II.Norm[[i]][j])
  }
}
```

##### Hassell's Type III FR Model

```{r}
# Initial Densities

N0 <- c(2, 3, 5, 10, 20, 30)

# Simulations

b.vec <- sample(seq(0.221, 3338468.210/1000000, 0.001), 1000, replace = TRUE) 
c.vec <- sample(seq(0.000, 1780576.771/1000000, 0.001), 1000, replace = TRUE) 
h.vec <- sample(seq(0.000, 0.289, 0.001), 1000, replace = TRUE)
Ex3.TSand.III.Unif <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex3.TSand.III.Unif[[i]][j] <- round(HassellIII(N0[i], b.vec[j], c.vec[j], h.vec[j], 2))
  }
}

b.vec <- rlnorm(1000, mean = log(1.181), sd = log(2))
c.vec <- rlnorm(1000, mean = log(1.163), sd = log(2))
h.vec <- rlnorm(1000, mean = log(0.058), sd = log(2))
Ex3.TSand.III.Norm <- vector(mode = 'list', length = length(N0))
for (i in 1:length(N0)){
  for (j in 1:1000){
    Ex3.TSand.III.Norm[[i]][j] <- round(HassellIII(N0[i], b.vec[j], c.vec[j], h.vec[j], 2))
  }
}

# Plotting

plot(1, type = "n", main = "Experiment 3, Sand Treatment: Hassell's Type III FR | Unif", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 30), ylim = c(0, 30))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex3.TSand.III.Unif[[i]][j])
  }
}

plot(1, type = "n", main = "Experiment 3, Sand Treatment: Hassell's Type III FR | Norm", xlab = "Initial Prey Density", ylab = "Number of Prey Eaten", xlim = c(0, 30), ylim = c(0, 30))
for (i in 1:length(N0)){
  for (j in 1:1000){
    points(x = N0[i], y = Ex3.TSand.III.Norm[[i]][j])
  }
}
```

## Model Fitting and Selection

**Data Structure:**

-   All the simulated data are stored in lists. Each list is named by experiment ("Ex"), treatment ("T"), functional response model ("II" or "III"), and sampling distribution ("Unif" or "Norm"). For example: "Ex1.TLow.III.Norm" denotes (1) Experiment 1, (2) Low Treatment, (3) Type III FR, (4) from a normal distribution.

-   Each list is of equal length to the number of initial prey densities used in the experiments (or, here, the length of the vector, $N_0$).

-   Each listen item contains a vector of length 1000. Each of these 1000 values is the output ($N_e$) of a single simulation.

### Changing Data Structure (Idiot Time)

#### Experiment 1

```{r}
N0 <- rep(c(4, 6, 10, 20, 60, 90, 120), times = 1000)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex1.TLow.II.Unif[[1]][i], 
              Ex1.TLow.II.Unif[[2]][i], 
              Ex1.TLow.II.Unif[[3]][i], 
              Ex1.TLow.II.Unif[[4]][i], 
              Ex1.TLow.II.Unif[[5]][i], 
              Ex1.TLow.II.Unif[[6]][i], 
              Ex1.TLow.II.Unif[[7]][i])
  Ne <- c(Ne, NeTemp)
}; TLow.II.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex1.TLow.II.Norm[[1]][i], 
              Ex1.TLow.II.Norm[[2]][i], 
              Ex1.TLow.II.Norm[[3]][i], 
              Ex1.TLow.II.Norm[[4]][i], 
              Ex1.TLow.II.Norm[[5]][i], 
              Ex1.TLow.II.Norm[[6]][i], 
              Ex1.TLow.II.Norm[[7]][i])
  Ne <- c(Ne, NeTemp)
}; TLow.II.Norm <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex1.TMed.II.Unif[[1]][i], 
              Ex1.TMed.II.Unif[[2]][i], 
              Ex1.TMed.II.Unif[[3]][i], 
              Ex1.TMed.II.Unif[[4]][i], 
              Ex1.TMed.II.Unif[[5]][i], 
              Ex1.TMed.II.Unif[[6]][i], 
              Ex1.TMed.II.Unif[[7]][i])
  Ne <- c(Ne, NeTemp)
}; TMed.II.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex1.TMed.II.Norm[[1]][i], 
              Ex1.TMed.II.Norm[[2]][i], 
              Ex1.TMed.II.Norm[[3]][i], 
              Ex1.TMed.II.Norm[[4]][i], 
              Ex1.TMed.II.Norm[[5]][i], 
              Ex1.TMed.II.Norm[[6]][i], 
              Ex1.TMed.II.Norm[[7]][i])
  Ne <- c(Ne, NeTemp)
}; TMed.II.Norm <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex1.TMed.III.Unif[[1]][i], 
              Ex1.TMed.III.Unif[[2]][i], 
              Ex1.TMed.III.Unif[[3]][i], 
              Ex1.TMed.III.Unif[[4]][i], 
              Ex1.TMed.III.Unif[[5]][i], 
              Ex1.TMed.III.Unif[[6]][i], 
              Ex1.TMed.III.Unif[[7]][i])
  Ne <- c(Ne, NeTemp)
}; TMed.III.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex1.TMed.III.Norm[[1]][i], 
              Ex1.TMed.III.Norm[[2]][i], 
              Ex1.TMed.III.Norm[[3]][i], 
              Ex1.TMed.III.Norm[[4]][i], 
              Ex1.TMed.III.Norm[[5]][i], 
              Ex1.TMed.III.Norm[[6]][i], 
              Ex1.TMed.III.Norm[[7]][i])
  Ne <- c(Ne, NeTemp)
}; TMed.III.Norm <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex1.THigh.II.Unif[[1]][i], 
              Ex1.THigh.II.Unif[[2]][i], 
              Ex1.THigh.II.Unif[[3]][i], 
              Ex1.THigh.II.Unif[[4]][i], 
              Ex1.THigh.II.Unif[[5]][i], 
              Ex1.THigh.II.Unif[[6]][i], 
              Ex1.THigh.II.Unif[[7]][i])
  Ne <- c(Ne, NeTemp)
}; THigh.II.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex1.THigh.II.Norm[[1]][i], 
              Ex1.THigh.II.Norm[[2]][i], 
              Ex1.THigh.II.Norm[[3]][i], 
              Ex1.THigh.II.Norm[[4]][i], 
              Ex1.THigh.II.Norm[[5]][i], 
              Ex1.THigh.II.Norm[[6]][i], 
              Ex1.THigh.II.Norm[[7]][i])
  Ne <- c(Ne, NeTemp)
}; THigh.II.Norm <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex1.THigh.III.Unif[[1]][i], 
              Ex1.THigh.III.Unif[[2]][i], 
              Ex1.THigh.III.Unif[[3]][i], 
              Ex1.THigh.III.Unif[[4]][i], 
              Ex1.THigh.III.Unif[[5]][i], 
              Ex1.THigh.III.Unif[[6]][i], 
              Ex1.THigh.III.Unif[[7]][i])
  Ne <- c(Ne, NeTemp)
}; THigh.III.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex1.THigh.III.Norm[[1]][i], 
              Ex1.THigh.III.Norm[[2]][i], 
              Ex1.THigh.III.Norm[[3]][i], 
              Ex1.THigh.III.Norm[[4]][i], 
              Ex1.THigh.III.Norm[[5]][i], 
              Ex1.THigh.III.Norm[[6]][i], 
              Ex1.THigh.III.Norm[[7]][i])
  Ne <- c(Ne, NeTemp)
}; THigh.III.Norm <- data.frame(Ne, N0)

Ex1SimDat <- list(TLow.II.Unif, TLow.II.Norm,
                  TMed.II.Unif, TMed.II.Norm, TMed.III.Unif, TMed.III.Norm,
                  THigh.II.Unif, THigh.II.Norm, THigh.III.Unif, THigh.III.Norm)
names(Ex1SimDat) <- c("TLow.II.Unif", "TLow.II.Norm",
                      "TMed.II.Unif", "TMed.II.Norm", "TMed.III.Unif", "TMed.III.Norm",
                      "THigh.II.Unif", "THigh.II.Norm", "THigh.III.Unif", "THigh.III.Norm")
saveRDS(Ex1SimDat, here("./SimOutputs/Ex1SimDat.rds"))
```

#### Experiment 2

```{r}
N0 <- rep(c(2, 3, 5, 10, 20, 30, 50), times = 1000)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex2.TLow.II.Unif[[1]][i], 
              Ex2.TLow.II.Unif[[2]][i], 
              Ex2.TLow.II.Unif[[3]][i], 
              Ex2.TLow.II.Unif[[4]][i], 
              Ex2.TLow.II.Unif[[5]][i], 
              Ex2.TLow.II.Unif[[6]][i], 
              Ex2.TLow.II.Unif[[7]][i])
  Ne <- c(Ne, NeTemp)
}; TLow.II.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex2.TLow.II.Norm[[1]][i], 
              Ex2.TLow.II.Norm[[2]][i], 
              Ex2.TLow.II.Norm[[3]][i], 
              Ex2.TLow.II.Norm[[4]][i], 
              Ex2.TLow.II.Norm[[5]][i], 
              Ex2.TLow.II.Norm[[6]][i], 
              Ex2.TLow.II.Norm[[7]][i])
  Ne <- c(Ne, NeTemp)
}; TLow.II.Norm <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex2.TLow.III.Unif[[1]][i], 
              Ex2.TLow.III.Unif[[2]][i], 
              Ex2.TLow.III.Unif[[3]][i], 
              Ex2.TLow.III.Unif[[4]][i], 
              Ex2.TLow.III.Unif[[5]][i], 
              Ex2.TLow.III.Unif[[6]][i], 
              Ex2.TLow.III.Unif[[7]][i])
  Ne <- c(Ne, NeTemp)
}; TLow.III.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex2.TLow.III.Norm[[1]][i], 
              Ex2.TLow.III.Norm[[2]][i], 
              Ex2.TLow.III.Norm[[3]][i], 
              Ex2.TLow.III.Norm[[4]][i], 
              Ex2.TLow.III.Norm[[5]][i], 
              Ex2.TLow.III.Norm[[6]][i], 
              Ex2.TLow.III.Norm[[7]][i])
  Ne <- c(Ne, NeTemp)
}; TLow.III.Norm <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex2.TMed.III.Unif[[1]][i], 
              Ex2.TMed.III.Unif[[2]][i], 
              Ex2.TMed.III.Unif[[3]][i], 
              Ex2.TMed.III.Unif[[4]][i], 
              Ex2.TMed.III.Unif[[5]][i], 
              Ex2.TMed.III.Unif[[6]][i], 
              Ex2.TMed.III.Unif[[7]][i])
  Ne <- c(Ne, NeTemp)
}; TMed.III.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex2.TMed.III.Norm[[1]][i], 
              Ex2.TMed.III.Norm[[2]][i], 
              Ex2.TMed.III.Norm[[3]][i], 
              Ex2.TMed.III.Norm[[4]][i], 
              Ex2.TMed.III.Norm[[5]][i], 
              Ex2.TMed.III.Norm[[6]][i], 
              Ex2.TMed.III.Norm[[7]][i])
  Ne <- c(Ne, NeTemp)
}; TMed.III.Norm <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex2.THigh.II.Unif[[1]][i], 
              Ex2.THigh.II.Unif[[2]][i], 
              Ex2.THigh.II.Unif[[3]][i], 
              Ex2.THigh.II.Unif[[4]][i], 
              Ex2.THigh.II.Unif[[5]][i], 
              Ex2.THigh.II.Unif[[6]][i], 
              Ex2.THigh.II.Unif[[7]][i])
  Ne <- c(Ne, NeTemp)
}; THigh.II.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex2.THigh.II.Norm[[1]][i], 
              Ex2.THigh.II.Norm[[2]][i], 
              Ex2.THigh.II.Norm[[3]][i], 
              Ex2.THigh.II.Norm[[4]][i], 
              Ex2.THigh.II.Norm[[5]][i], 
              Ex2.THigh.II.Norm[[6]][i], 
              Ex2.THigh.II.Norm[[7]][i])
  Ne <- c(Ne, NeTemp)
}; THigh.II.Norm <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex2.THigh.III.Unif[[1]][i], 
              Ex2.THigh.III.Unif[[2]][i], 
              Ex2.THigh.III.Unif[[3]][i], 
              Ex2.THigh.III.Unif[[4]][i], 
              Ex2.THigh.III.Unif[[5]][i], 
              Ex2.THigh.III.Unif[[6]][i], 
              Ex2.THigh.III.Unif[[7]][i])
  Ne <- c(Ne, NeTemp)
}; THigh.III.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex2.THigh.III.Norm[[1]][i], 
              Ex2.THigh.III.Norm[[2]][i], 
              Ex2.THigh.III.Norm[[3]][i], 
              Ex2.THigh.III.Norm[[4]][i], 
              Ex2.THigh.III.Norm[[5]][i], 
              Ex2.THigh.III.Norm[[6]][i], 
              Ex2.THigh.III.Norm[[7]][i])
  Ne <- c(Ne, NeTemp)
}; THigh.III.Norm <- data.frame(Ne, N0)

Ex2SimDat <- list(TLow.II.Unif, TLow.II.Norm, TLow.III.Unif, TLow.III.Norm,
                  TMed.III.Unif, TMed.III.Norm,
                  THigh.II.Unif, THigh.II.Norm, THigh.III.Unif, THigh.III.Norm)
names(Ex2SimDat) <- c("TLow.II.Unif", "TLow.II.Norm", "TLow.III.Unif", "TLow.III.Norm",
                      "TMed.III.Unif", "TMed.III.Norm",
                      "THigh.II.Unif", "THigh.II.Norm", "THigh.III.Unif", "THigh.III.Norm")
saveRDS(Ex2SimDat, here("./SimOutputs/Ex2SimDat.rds"))
```

#### Experiment 3

```{r}
N0 <- rep(c(2, 3, 5, 10, 20, 30), times = 1000)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex3.TRocks.II.Unif[[1]][i], 
              Ex3.TRocks.II.Unif[[2]][i], 
              Ex3.TRocks.II.Unif[[3]][i], 
              Ex3.TRocks.II.Unif[[4]][i], 
              Ex3.TRocks.II.Unif[[5]][i], 
              Ex3.TRocks.II.Unif[[6]][i])
  Ne <- c(Ne, NeTemp)
}; TRocks.II.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex3.TRocks.II.Norm[[1]][i], 
              Ex3.TRocks.II.Norm[[2]][i], 
              Ex3.TRocks.II.Norm[[3]][i], 
              Ex3.TRocks.II.Norm[[4]][i], 
              Ex3.TRocks.II.Norm[[5]][i], 
              Ex3.TRocks.II.Norm[[6]][i])
  Ne <- c(Ne, NeTemp)
}; TRocks.II.Norm <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex3.TSand.II.Unif[[1]][i], 
              Ex3.TSand.II.Unif[[2]][i], 
              Ex3.TSand.II.Unif[[3]][i], 
              Ex3.TSand.II.Unif[[4]][i], 
              Ex3.TSand.II.Unif[[5]][i], 
              Ex3.TSand.II.Unif[[6]][i])
  Ne <- c(Ne, NeTemp)
}; TSand.II.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex3.TSand.II.Norm[[1]][i], 
              Ex3.TSand.II.Norm[[2]][i], 
              Ex3.TSand.II.Norm[[3]][i], 
              Ex3.TSand.II.Norm[[4]][i], 
              Ex3.TSand.II.Norm[[5]][i], 
              Ex3.TSand.II.Norm[[6]][i])
  Ne <- c(Ne, NeTemp)
}; TSand.II.Norm <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex3.TSand.III.Unif[[1]][i], 
              Ex3.TSand.III.Unif[[2]][i], 
              Ex3.TSand.III.Unif[[3]][i], 
              Ex3.TSand.III.Unif[[4]][i], 
              Ex3.TSand.III.Unif[[5]][i], 
              Ex3.TSand.III.Unif[[6]][i])
  Ne <- c(Ne, NeTemp)
}; TSand.III.Unif <- data.frame(Ne, N0)

Ne <- c()
for (i in 1:1000){
  NeTemp <- c(Ex3.TSand.III.Norm[[1]][i], 
              Ex3.TSand.III.Norm[[2]][i], 
              Ex3.TSand.III.Norm[[3]][i], 
              Ex3.TSand.III.Norm[[4]][i], 
              Ex3.TSand.III.Norm[[5]][i], 
              Ex3.TSand.III.Norm[[6]][i])
  Ne <- c(Ne, NeTemp)
}; TSand.III.Norm <- data.frame(Ne, N0)

Ex3SimDat <- list(TRocks.II.Unif, TRocks.II.Norm,
                  TSand.II.Unif, TSand.II.Norm, TSand.III.Unif, TSand.III.Norm)
names(Ex3SimDat) <- c("TRocks.II.Unif", "TRocks.II.Norm",
                      "TSand.II.Unif", "TSand.II.Norm", "TSand.III.Unif", "TSand.III.Norm")
saveRDS(Ex3SimDat, here("./SimOutputs/Ex3SimDat.rds"))
```

### Method (1): Juliano's

Writing the function to sort outcomes.

```{r}
getType.Juliano <- function(x) {
  stopifnot(inherits(x, "frtest"))

  T2Coef <- coef(summary(x$modT2))
  T2CoefOut <- T2Coef[2, ] |> matrix(nrow = 1)
  
  T3Coef <- coef(summary(x$modT3))
  T3CoefOut <- T3Coef[2:3, ]
  
  Type <- if(T2CoefOut[1, 1] < 0 & T2CoefOut[1, 4] < 0.05) {
    "type-II response"
  } else if (T3CoefOut[1, 1] > 0 & 
             T3CoefOut[1, 4] < 0.05 & 
             T3CoefOut[2, 1] < 0 & 
             T3CoefOut[2, 4] < 0.05) {
    "type-III response"
  }
  else {
    "No evidence for any response."
  }
  Type
}
```

#### One Test Per Row

```{r echo = T, results = 'hide'}
## Experiment 1
N0 <- c(4, 6, 10, 20, 60, 90, 120)
Out.List.Outer <-  vector(mode = 'list', length = length(Ex1SimDat)) 
suppressWarnings({
for (i in 1:length(Ex1SimDat)){
  Out.List.Inner <-  vector(mode = 'list', length = 1000)
  m <- 1; n <- 7
  for (j in 1:1000){
    SimDat <- Ex1SimDat[[i]][m:n, ]
    Output <- tryCatch({frair_test(formula = Ne ~ N0, data = SimDat)},
                       warning = function(w) {
                         cat("Warning: couldn't invert Hessian", conditionMessage(w), "\n")
                             "Warning or Error"},
                       error = function(e) {
                         cat("Error in frfunc", conditionMessage(e), "\n")
                         "Warning or Error"})
    Out.List.Inner[[j]] <- Output
    m <- m + 7; n <- n + 7
  }
  Out.List.Outer[[i]] <- Out.List.Inner
}})
Ex1.Prop <- c() 
for (i in 1:length(Ex1SimDat)){
  Temp <- c()
  for (j in 1:length(Out.List.Outer[[i]])){
    Temp[j] <- if (!is.list(Out.List.Outer[[i]][[j]])){
      "Warning or Error"
    } else {
      getType.Juliano(Out.List.Outer[[i]][[j]])
    }
  }
  CIH.II.III.NA <- c(length(which(Temp == "Warning or Error")),
                     length(which(Temp == "type-II response")),
                     length(which(Temp == "type-III response")),
                     length(which(Temp == "No evidence for any response.")))
  Ex1.Prop <- rbind(Ex1.Prop, CIH.II.III.NA)
}
colnames(Ex1.Prop) <- c("Warning or Error", "II", "III", "No Evidence")
rownames(Ex1.Prop) <- c("TLow.II.Unif", "TLow.II.Norm",
                        "TMed.II.Unif", "TMed.II.Norm", "TMed.III.Unif", "TMed.III.Norm",
                        "THigh.II.Unif", "THigh.II.Norm", "THigh.III.Unif", "THigh.III.Norm")

## Experiment 2
N0 <- c(2, 3, 5, 10, 20, 30, 50)
Out.List.Outer <-  vector(mode = 'list', length = length(Ex2SimDat)) 
suppressWarnings({
for (i in 1:length(Ex2SimDat)){
  Out.List.Inner <-  vector(mode = 'list', length = 1000)
  m <- 1; n <- 7
  for (j in 1:1000){
    SimDat <- Ex2SimDat[[i]][m:n, ]
    Output <- tryCatch({frair_test(formula = Ne ~ N0, data = SimDat)},
                       warning = function(w) {
                         cat("Warning: couldn't invert Hessian", conditionMessage(w), "\n")
                             "Warning or Error"},
                       error = function(e) {
                         cat("Error in frfunc", conditionMessage(e), "\n")
                         "Warning or Error"})
    Out.List.Inner[[j]] <- Output
    m <- m + 7; n <- n + 7
  }
  Out.List.Outer[[i]] <- Out.List.Inner
}})
Ex2.Prop <- c() 
for (i in 1:length(Ex2SimDat)){
  Temp <- c()
  for (j in 1:length(Out.List.Outer[[i]])){
    Temp[j] <- if (!is.list(Out.List.Outer[[i]][[j]])){
      "Warning or Error"
    } else {
      getType.Juliano(Out.List.Outer[[i]][[j]])
    }
  }
  CIH.II.III.NA <- c(length(which(Temp == "Warning or Error")),
                     length(which(Temp == "type-II response")),
                     length(which(Temp == "type-III response")),
                     length(which(Temp == "No evidence for any response.")))
  Ex2.Prop <- rbind(Ex2.Prop, CIH.II.III.NA)
}
colnames(Ex2.Prop) <- c("Warning or Error", "II", "III", "No Evidence")
rownames(Ex2.Prop) <- c("TLow.II.Unif", "TLow.II.Norm", "TLow.III.Unif", "TLow.III.Norm",
                        "TMed.III.Unif", "TMed.III.Norm",
                        "THigh.II.Unif", "THigh.II.Norm", "THigh.III.Unif", "THigh.III.Norm")

## Experiment 3
N0 <- c(2, 3, 5, 10, 20, 30)
Out.List.Outer <-  vector(mode = 'list', length = length(Ex3SimDat)) 
suppressWarnings({
for (i in 1:length(Ex3SimDat)){
  Out.List.Inner <-  vector(mode = 'list', length = 1000)
  m <- 1; n <- 6
  for (j in 1:1000){
    SimDat <- Ex3SimDat[[i]][m:n, ]
    Output <- tryCatch({frair_test(formula = Ne ~ N0, data = SimDat)},
                       warning = function(w) {
                         cat("Warning: couldn't invert Hessian", conditionMessage(w), "\n")
                             "Warning or Error"},
                       error = function(e) {
                         cat("Error in frfunc", conditionMessage(e), "\n")
                         "Warning or Error"})
    Out.List.Inner[[j]] <- Output
    m <- m + 6; n <- n + 6
  }
  Out.List.Outer[[i]] <- Out.List.Inner
}})
Ex3.Prop <- c() 
for (i in 1:length(Ex3SimDat)){
  Temp <- c()
  for (j in 1:length(Out.List.Outer[[i]])){
    Temp[j] <- if (!is.list(Out.List.Outer[[i]][[j]])){
      "Warning or Error"
    } else {
      getType.Juliano(Out.List.Outer[[i]][[j]])
    }
  }
  CIH.II.III.NA <- c(length(which(Temp == "Warning or Error")),
                     length(which(Temp == "type-II response")),
                     length(which(Temp == "type-III response")),
                     length(which(Temp == "No evidence for any response.")))
  Ex3.Prop <- rbind(Ex3.Prop, CIH.II.III.NA)
}
colnames(Ex3.Prop) <- c("Warning or Error", "II", "III", "No Evidence")
rownames(Ex3.Prop) <- c("TRocks.II.Unif", "TRocks.II.Norm",
                        "TSand.II.Unif", "TSand.II.Norm", "TSand.III.Unif", "TSand.III.Norm")

## SAVING OUTPUTS
saveRDS(Ex1.Prop, here("./SimOutputs/Ex1Prop_Juliano.rds"))
saveRDS(Ex2.Prop, here("./SimOutputs/Ex2Prop_Juliano.rds"))
saveRDS(Ex3.Prop, here("./SimOutputs/Ex3Prop_Juliano.rds"))
```

#### Summarising Results

```{r}
Ex1.Prop <- readRDS(here("./SimOutputs/Ex1Prop_Juliano.rds"))
Ex2.Prop <- readRDS(here("./SimOutputs/Ex2Prop_Juliano.rds"))
Ex3.Prop <- readRDS(here("./SimOutputs/Ex3Prop_Juliano.rds"))

## Experiment 1
Cases <- c("TLow.II.Unif", "TLow.II.Norm",
           "TMed.II.Unif", "TMed.II.Norm", "TMed.III.Unif", "TMed.III.Norm",
           "THigh.II.Unif", "THigh.II.Norm", "THigh.III.Unif", "THigh.III.Norm")
par(mar = c(8, 5, 4, 3))
plot(x = 1:10, y = as.numeric(Ex1.Prop[ ,1]), col = "orchid", pch = c(8, 8, 8, 8, 19, 19, 8, 8, 19, 19), 
     main = "Experiment 1", xlab = "", ylab = "Number of Simulations (/1000)",
     ylim = c(0, 1000), xaxt = "n")
points(x = 1:10, y = as.numeric(Ex1.Prop[ ,2]), col = "cornflowerblue", pch = c(19, 19, 19, 19, 8, 8, 19, 19, 8, 8))
points(x = 1:10, y = as.numeric(Ex1.Prop[ ,3]), col = "goldenrod2", pch = 19)
axis(1, at = 1:10, labels = Cases, las = 2)

## Experiment 2
Cases <- c("TLow.II.Unif", "TLow.II.Norm", "TLow.III.Unif", "TLow.III.Norm",
           "TMed.III.Unif", "TMed.III.Norm",
           "THigh.II.Unif", "THigh.II.Norm", "THigh.III.Unif", "THigh.III.Norm")
par(mar = c(8, 5, 4, 3))
plot(x = 1:10, y = as.numeric(Ex2.Prop[ ,1]), col = "orchid", pch = c(8, 8, 19, 19, 19, 19, 8, 8, 19, 19), 
     main = "Experiment 2", xlab = "", ylab = "Number of Simulations (/1000)",
     ylim = c(0, 1000), xaxt = "n")
points(x = 1:10, y = as.numeric(Ex2.Prop[ ,2]), col = "cornflowerblue", pch = c(19, 19, 8, 8, 8, 8, 19, 19, 8, 8))
points(x = 1:10, y = as.numeric(Ex2.Prop[ ,3]), col = "goldenrod2", pch = 19)
axis(1, at = 1:10, labels = Cases, las = 2)

## Experiment 3
Cases <- c("TRocks.II.Unif", "TRocks.II.Norm",
           "TSand.II.Unif", "TSand.II.Norm", "TSand.III.Unif", "TSand.III.Norm")
par(mar = c(8, 5, 4, 3))
plot(x = 1:6, y = as.numeric(Ex3.Prop[ ,1]), col = "orchid", pch = c(8, 8, 8, 8, 19, 19), 
     main = "Experiment 3", xlab = "", ylab = "Number of Simulations (/1000)",
     ylim = c(0, 1000), xaxt = "n")
points(x = 1:6, y = as.numeric(Ex3.Prop[ ,2]), col = "cornflowerblue", pch = c(19, 19, 19, 19, 8, 8))
points(x = 1:6, y = as.numeric(Ex3.Prop[ ,3]), col = "goldenrod2", pch = 19)
axis(1, at = 1:6, labels = Cases, las = 2)
```

### Method (2): Generalized FR w/ Scaling Exponent

Writing the function to sort outcomes.

```{r}
getType.FlexFR <- function(x){
  stopifnot(inherits(x, "frfit"))
  Pr <- coef(summary(x$fit))[2, 4]
  Type <- if(is.na(Pr)) {
    "No evidence for any response."
  } else if (Pr <= 0.05) {
    "type-II response"
  } else {
    "type-III response"
  }
  Type
}
```

#### One Test Per Row

```{r echo = T, results = 'hide'}
## Experiment 1
N0 <- c(4, 6, 10, 20, 60, 90, 120)
Out.List.Outer <-  vector(mode = 'list', length = length(Ex1SimDat)) 
suppressWarnings({
for (i in 1:length(Ex1SimDat)){
  Out.List.Inner <-  vector(mode = 'list', length = 1000)
  m <- 1; n <- 7
  for (j in 1:1000){
    SimDat <- Ex1SimDat[[i]][m:n, ]
    Output <- tryCatch({frair_fit(formula = Ne ~ N0, data = SimDat, response = "flexpnr",
                        start = list(b = 0.5, q = 0, h= 0.5), fixed = list(T = 6))},
                       warning = function(w) {
                         cat("Warning: couldn't invert Hessian", conditionMessage(w), "\n")
                             "Warning or Error"},
                       error = function(e) {
                         cat("Error in frfunc", conditionMessage(e), "\n")
                         "Warning or Error"})
    Out.List.Inner[[j]] <- Output
    m <- m + 7; n <- n + 7
  }
  Out.List.Outer[[i]] <- Out.List.Inner
}})
Ex1.Prop <- c() 
for (i in 1:length(Ex1SimDat)){
  Temp <- c()
  for (j in 1:length(Out.List.Outer[[i]])){
    Temp[j] <- if (!is.list(Out.List.Outer[[i]][[j]])){
      "Warning or Error"
    } else {
      getType.FlexFR(Out.List.Outer[[i]][[j]])
    }
  }
  CIH.II.III.NA <- c(length(which(Temp == "Warning or Error")),
                     length(which(Temp == "type-II response")),
                     length(which(Temp == "type-III response")),
                     length(which(Temp == "No evidence for any response.")))
  Ex1.Prop <- rbind(Ex1.Prop, CIH.II.III.NA)
}
colnames(Ex1.Prop) <- c("Warning or Error", "II", "III", "No Evidence")
rownames(Ex1.Prop) <- c("TLow.II.Unif", "TLow.II.Norm",
                        "TMed.II.Unif", "TMed.II.Norm", "TMed.III.Unif", "TMed.III.Norm",
                        "THigh.II.Unif", "THigh.II.Norm", "THigh.III.Unif", "THigh.III.Norm")

## Experiment 2
N0 <- c(2, 3, 5, 10, 20, 30, 50)
Out.List.Outer <-  vector(mode = 'list', length = length(Ex2SimDat)) 
suppressWarnings({
for (i in 1:length(Ex2SimDat)){
  Out.List.Inner <-  vector(mode = 'list', length = 1000)
  m <- 1; n <- 7
  for (j in 1:1000){
    SimDat <- Ex2SimDat[[i]][m:n, ]
    Output <- tryCatch({frair_fit(formula = Ne ~ N0, data = SimDat, response = "flexpnr",
                        start = list(b = 0.5, q = 0, h= 0.5), fixed = list(T = 6))},
                       warning = function(w) {
                         cat("Warning: couldn't invert Hessian", conditionMessage(w), "\n")
                             "Warning or Error"},
                       error = function(e) {
                         cat("Error in frfunc", conditionMessage(e), "\n")
                         "Warning or Error"})
    Out.List.Inner[[j]] <- Output
    m <- m + 7; n <- n + 7
  }
  Out.List.Outer[[i]] <- Out.List.Inner
}})
Ex2.Prop <- c() 
for (i in 1:length(Ex2SimDat)){
  Temp <- c()
  for (j in 1:length(Out.List.Outer[[i]])){
    Temp[j] <- if (!is.list(Out.List.Outer[[i]][[j]])){
      "Warning or Error"
    } else {
      getType.FlexFR(Out.List.Outer[[i]][[j]])
    }
  }
  CIH.II.III.NA <- c(length(which(Temp == "Warning or Error")),
                     length(which(Temp == "type-II response")),
                     length(which(Temp == "type-III response")),
                     length(which(Temp == "No evidence for any response.")))
  Ex2.Prop <- rbind(Ex2.Prop, CIH.II.III.NA)
}
colnames(Ex2.Prop) <- c("Warning or Error", "II", "III", "No Evidence")
rownames(Ex2.Prop) <- c("TLow.II.Unif", "TLow.II.Norm", "TLow.III.Unif", "TLow.III.Norm",
                        "TMed.III.Unif", "TMed.III.Norm",
                        "THigh.II.Unif", "THigh.II.Norm", "THigh.III.Unif", "THigh.III.Norm")

## Experiment 3
N0 <- c(2, 3, 5, 10, 20, 30)
Out.List.Outer <-  vector(mode = 'list', length = length(Ex3SimDat)) 
suppressWarnings({
for (i in 1:length(Ex3SimDat)){
  Out.List.Inner <-  vector(mode = 'list', length = 1000)
  m <- 1; n <- 7
  for (j in 1:1000){
    SimDat <- Ex3SimDat[[i]][m:n, ]
    Output <- tryCatch({frair_fit(formula = Ne ~ N0, data = SimDat, response = "flexpnr",
                        start = list(b = 0.5, q = 0, h= 0.5), fixed = list(T = 6))},
                       warning = function(w) {
                         cat("Warning: couldn't invert Hessian", conditionMessage(w), "\n")
                             "Warning or Error"},
                       error = function(e) {
                         cat("Error in frfunc", conditionMessage(e), "\n")
                         "Warning or Error"})
    Out.List.Inner[[j]] <- Output
    m <- m + 7; n <- n + 7
  }
  Out.List.Outer[[i]] <- Out.List.Inner
}})
Ex3.Prop <- c() 
for (i in 1:length(Ex3SimDat)){
  Temp <- c()
  for (j in 1:length(Out.List.Outer[[i]])){
    Temp[j] <- if (!is.list(Out.List.Outer[[i]][[j]])){
      "Warning or Error"
    } else {
      getType.FlexFR(Out.List.Outer[[i]][[j]])
    }
  }
  CIH.II.III.NA <- c(length(which(Temp == "Warning or Error")),
                     length(which(Temp == "type-II response")),
                     length(which(Temp == "type-III response")),
                     length(which(Temp == "No evidence for any response.")))
  Ex3.Prop <- rbind(Ex3.Prop, CIH.II.III.NA)
}
colnames(Ex3.Prop) <- c("Warning or Error", "II", "III", "No Evidence")
rownames(Ex3.Prop) <- c("TRocks.II.Unif", "TRocks.II.Norm",
                        "TSand.II.Unif", "TSand.II.Norm", "TSand.III.Unif", "TSand.III.Norm")

## SAVING OUTPUTS
saveRDS(Ex1.Prop, here("./SimOutputs/Ex1Prop_FlexFR.rds"))
saveRDS(Ex2.Prop, here("./SimOutputs/Ex2Prop_FlexFR.rds"))
saveRDS(Ex3.Prop, here("./SimOutputs/Ex3Prop_FlexFR.rds"))
```

#### Summarising Results

```{r}
Ex1.Prop <- readRDS(here("./SimOutputs/Ex1Prop_FlexFR.rds"))
Ex2.Prop <- readRDS(here("./SimOutputs/Ex2Prop_FlexFR.rds"))
Ex3.Prop <- readRDS(here("./SimOutputs/Ex3Prop_FlexFR.rds"))

## Experiment 1
Cases <- c("TLow.II.Unif", "TLow.II.Norm",
           "TMed.II.Unif", "TMed.II.Norm", "TMed.III.Unif", "TMed.III.Norm",
           "THigh.II.Unif", "THigh.II.Norm", "THigh.III.Unif", "THigh.III.Norm")
par(mar = c(8, 5, 4, 3))
plot(x = 1:10, y = as.numeric(Ex1.Prop[ ,1]), col = "orchid", pch = c(8, 8, 8, 8, 19, 19, 8, 8, 19, 19), 
     main = "Experiment 1", xlab = "", ylab = "Number of Simulations (/1000)",
     ylim = c(0, 1000), xaxt = "n")
points(x = 1:10, y = as.numeric(Ex1.Prop[ ,2]), col = "cornflowerblue", pch = c(19, 19, 19, 19, 8, 8, 19, 19, 8, 8))
points(x = 1:10, y = as.numeric(Ex1.Prop[ ,3]), col = "goldenrod2", pch = 19)
axis(1, at = 1:10, labels = Cases, las = 2)

## Experiment 2
Cases <- c("TLow.II.Unif", "TLow.II.Norm", "TLow.III.Unif", "TLow.III.Norm",
           "TMed.III.Unif", "TMed.III.Norm",
           "THigh.II.Unif", "THigh.II.Norm", "THigh.III.Unif", "THigh.III.Norm")
par(mar = c(8, 5, 4, 3))
plot(x = 1:10, y = as.numeric(Ex2.Prop[ ,1]), col = "orchid", pch = c(8, 8, 19, 19, 19, 19, 8, 8, 19, 19), 
     main = "Experiment 2", xlab = "", ylab = "Number of Simulations (/1000)",
     ylim = c(0, 1000), xaxt = "n")
points(x = 1:10, y = as.numeric(Ex2.Prop[ ,2]), col = "cornflowerblue", pch = c(19, 19, 8, 8, 8, 8, 19, 19, 8, 8))
points(x = 1:10, y = as.numeric(Ex2.Prop[ ,3]), col = "goldenrod2", pch = 19)
axis(1, at = 1:10, labels = Cases, las = 2)

## Experiment 3
Cases <- c("TRocks.II.Unif", "TRocks.II.Norm",
           "TSand.II.Unif", "TSand.II.Norm", "TSand.III.Unif", "TSand.III.Norm")
par(mar = c(8, 5, 4, 3))
plot(x = 1:6, y = as.numeric(Ex3.Prop[ ,1]), col = "orchid", pch = c(8, 8, 8, 8, 19, 19), 
     main = "Experiment 3", xlab = "", ylab = "Number of Simulations (/1000)",
     ylim = c(0, 1000), xaxt = "n")
points(x = 1:6, y = as.numeric(Ex3.Prop[ ,2]), col = "cornflowerblue", pch = c(19, 19, 19, 19, 8, 8))
points(x = 1:6, y = as.numeric(Ex3.Prop[ ,3]), col = "goldenrod2", pch = 19)
axis(1, at = 1:6, labels = Cases, las = 2)
```

### Plotting Methods (1) and (2) Together

```{r}
Ex1.Prop.J <- readRDS(here("./SimOutputs/Ex1Prop_Juliano.rds"))
Ex1.Prop.F <- readRDS(here("./SimOutputs/Ex1Prop_FlexFR.rds"))

Ex1.Unif.Js <- c(Ex1.Prop.J[1,1], Ex1.Prop.J[3,1], Ex1.Prop.J[5,2], Ex1.Prop.J[7,1], Ex1.Prop.J[9,2])
Ex1.Unif.Flex <- c(Ex1.Prop.F[1,1], Ex1.Prop.F[3,1], Ex1.Prop.F[5,2], Ex1.Prop.F[7,1], Ex1.Prop.F[9,2])
par(mar = c(5.1, 4.1, 4.1, 9.1), xpd = TRUE)
Cases <- c("TLow.II.Unif", "TMed.II.Unif", "TMed.III.Unif", "THigh.II.Unif", "THigh.III.Unif")
plot(x = 1:5, y = Ex1.Unif.Js, col = alpha("orchid", 0.5), pch = 19, cex = 2,
     main = "Experiment 1 (Draw from 'runif')", xlab = "", ylab = "Number of Simulations (/1000)",
     ylim = c(0, 1000), xaxt = "n")
points(x = 1:5, y = Ex1.Unif.Flex, col = alpha("goldenrod2", 0.5), pch = 19, cex = 2)
axis(1, at = 1:5, labels = c("Low, II", "Med., II", "Med., III", "High, II", "High, III"))
legend("topright", inset = c(-0.5, 0), legend = c("Juliano's", "Flexible FR"), col = c("orchid", "goldenrod2"), pch = 19, cex = 1, bty = "n")

Ex1.Unif.Js <- c(Ex1.Prop.J[2,1], Ex1.Prop.J[4,1], Ex1.Prop.J[6,2], Ex1.Prop.J[8,1], Ex1.Prop.J[10,2])
Ex1.Unif.Flex <- c(Ex1.Prop.F[2,1], Ex1.Prop.F[4,1], Ex1.Prop.F[6,2], Ex1.Prop.F[8,1], Ex1.Prop.F[10,2])
par(mar = c(5.1, 4.1, 4.1, 9.1), xpd = TRUE)
Cases <- c("TLow.II.Unif", "TMed.II.Unif", "TMed.III.Unif", "THigh.II.Unif", "THigh.III.Unif")
plot(x = 1:5, y = Ex1.Unif.Js, col = alpha("orchid", 0.5), pch = 19, cex = 2,
     main = "Experiment 1 (Draw from 'rnorm')", xlab = "", ylab = "Number of Simulations (/1000)",
     ylim = c(0, 1000), xaxt = "n")
points(x = 1:5, y = Ex1.Unif.Flex, col = alpha("goldenrod2", 0.4), pch = 19, cex = 2)
axis(1, at = 1:5, labels = c("Low, II", "Med., II", "Med., III", "High, II", "High, III"))
legend("topright", inset = c(-0.5, 0), legend = c("Juliano's", "Flexible FR"), col = c("orchid", "goldenrod2"), pch = 19, cex = 1, bty = "n")

Ex2.Prop.J <- readRDS(here("./SimOutputs/Ex2Prop_Juliano.rds"))
Ex2.Prop.F <- readRDS(here("./SimOutputs/Ex2Prop_FlexFR.rds"))

Ex2.Unif.Js <- c(Ex2.Prop.J[1,1], Ex2.Prop.J[3,2], Ex2.Prop.J[5,2], Ex2.Prop.J[7,1], Ex2.Prop.J[9,2])
Ex2.Unif.Flex <- c(Ex2.Prop.F[1,1], Ex2.Prop.F[3,2], Ex2.Prop.F[5,2], Ex2.Prop.F[7,1], Ex2.Prop.F[9,2])
par(mar = c(5.1, 4.1, 4.1, 9.1), xpd = TRUE)
Cases <- c("TLow.II.Unif", "TLow.III.Unif", "TMed.III.Unif", "THigh.II.Unif", "THigh.III.Unif")
plot(x = 1:5, y = Ex2.Unif.Js, col = alpha("orchid", 0.5), pch = 19, cex = 2,
     main = "Experiment 2 (Draw from 'runif')", xlab = "", ylab = "Number of Simulations (/1000)",
     ylim = c(0, 1000), xaxt = "n")
points(x = 1:5, y = Ex2.Unif.Flex, col = alpha("goldenrod2", 0.5), pch = 19, cex = 2)
axis(1, at = 1:5, labels = c("Low, II", "Low, III", "Med., III", "High, II", "High, III"))
legend("topright", inset = c(-0.5, 0), legend = c("Juliano's", "Flexible FR"), col = c("orchid", "goldenrod2"), pch = 19, cex = 1, bty = "n")

Ex2.Norm.Js <- c(Ex2.Prop.J[2,1], Ex2.Prop.J[4,2], Ex2.Prop.J[6,2], Ex2.Prop.J[8,1], Ex2.Prop.J[10,2])
Ex2.Norm.Flex <- c(Ex2.Prop.F[2,1], Ex2.Prop.F[4,2], Ex2.Prop.F[6,2], Ex2.Prop.F[8,1], Ex2.Prop.F[10,2])
par(mar = c(5.1, 4.1, 4.1, 9.1), xpd = TRUE)
Cases <- c("TLow.II.Norm", "TLow.III.Norm", "TMed.III.Norm", "THigh.II.Norm", "THigh.III.Norm")
plot(x = 1:5, y = Ex2.Norm.Js, col = alpha("orchid", 0.5), pch = 19, cex = 2,
     main = "Experiment 2 (Draw from 'rnorm')", xlab = "", ylab = "Number of Simulations (/1000)",
     ylim = c(0, 1000), xaxt = "n")
points(x = 1:5, y = Ex2.Norm.Flex, col = alpha("goldenrod2", 0.4), pch = 19, cex = 2)
axis(1, at = 1:5, labels = c("Low, II", "Med., II", "Med., III", "High, II", "High, III"))
legend("topright", inset = c(-0.5, 0), legend = c("Juliano's", "Flexible FR"), col = c("orchid", "goldenrod2"), pch = 19, cex = 1, bty = "n")

Ex3.Prop.J <- readRDS(here("./SimOutputs/Ex3Prop_Juliano.rds"))
Ex3.Prop.F <- readRDS(here("./SimOutputs/Ex3Prop_FlexFR.rds"))

Ex3.Unif.Js <- c(Ex3.Prop.J[1,1], Ex3.Prop.J[3,1], Ex3.Prop.J[5,2])
Ex3.Unif.Flex <- c(Ex3.Prop.F[1,1], Ex3.Prop.F[3,1], Ex3.Prop.F[5,2])
par(mar = c(5.1, 4.1, 4.1, 9.1), xpd = TRUE)
Cases <- c("TRocks.II.Unif", "TSand.II.Unif", "TSand.III.Unif")
plot(x = 1:3, y = Ex3.Unif.Js, col = alpha("orchid", 0.5), pch = 19, cex = 2,
     main = "Experiment 3 (Draw from 'runif')", xlab = "", ylab = "Number of Simulations (/1000)",
     ylim = c(0, 1000), xaxt = "n")
points(x = 1:3, y = Ex3.Unif.Flex, col = alpha("goldenrod2", 0.5), pch = 19, cex = 2)
axis(1, at = 1:3, labels = c("Rocks, II", "Sand, II", "Sand, III"))
legend("topright", inset = c(-0.5, 0), legend = c("Juliano's", "Flexible FR"), col = c("orchid", "goldenrod2"), pch = 19, cex = 1, bty = "n")

Ex3.Norm.Js <- c(Ex3.Prop.J[2,1], Ex3.Prop.J[4,1], Ex3.Prop.J[6,2])
Ex3.Norm.Flex <- c(Ex3.Prop.F[2,1], Ex3.Prop.F[4,1], Ex3.Prop.F[6,2])
par(mar = c(5.1, 4.1, 4.1, 9.1), xpd = TRUE)
Cases <- c("TRocks.II.Norm", "TSand.II.Norm", "TSand.III.Norm")
plot(x = 1:3, y = Ex3.Norm.Js, col = alpha("orchid", 0.5), pch = 19, cex = 2,
     main = "Experiment 3 (Draw from 'rnorm')", xlab = "", ylab = "Number of Simulations (/1000)",
     ylim = c(0, 1000), xaxt = "n")
points(x = 1:3, y = Ex3.Norm.Flex, col = alpha("goldenrod2", 0.5), pch = 19, cex = 2)
axis(1, at = 1:3, labels = c("Rocks, II", "Sand, II", "Sand, III"))
legend("topright", inset = c(-0.5, 0), legend = c("Juliano's", "Flexible FR"), col = c("orchid", "goldenrod2"), pch = 19, cex = 1, bty = "n")
```

### Method (3): AIC

```{r echo = T, results = 'hide'}
## Experiment 1
N0 <- c(4, 6, 10, 20, 60, 90, 120)
Out.List.Outer <-  vector(mode = 'list', length = length(Ex1SimDat)) 
suppressWarnings({
for (i in 1:length(Ex1SimDat)){
  Out.List.Inner <-  vector(mode = 'list', length = 1000)
  m <- 1; n <- 7
  for (j in 1:1000){
    SimDat <- Ex1SimDat[[i]][m:n, ]
    Output.II <- tryCatch({frair_fit(Ne ~ N0, data = SimDat, response = 'rogersII',
                           start = list(a = 1, h = 0.1), fixed = list(T = 2))},
                          warning = function(w) {
                             cat("Warning: couldn't invert Hessian", conditionMessage(w), "\n")
                             "Couldn't invert Hessian"})
    Output.III <- tryCatch({frair_fit(Ne ~ N0, data = SimDat, response = 'hassIIInr',
                            start = list(b = 1, c = 1, h = 0.1), fixed = list(T = 2))},
                           warning = function(w) {
                             cat("Warning: couldn't invert Hessian", conditionMessage(w), "\n")
                             "Couldn't invert Hessian"})
    if (is.list(Output.II) & is.list(Output.III)) {
    AIC.Out <- ICtab(c(Output.II$fit, Output.III$fit), type = "AICc",
                     mnames = c("Output.II$fit", "Output.III$fit"), 
                     weights = TRUE, nobs = nrow(SimDat))}
    Output <- if (!is.list(Output.II) | !is.list(Output.III)) {
      "Warning or Error"
    } else if  (AIC.Out$dAICc[1] == 0 & (AIC.Out$dAICc[1] + 2) <= AIC.Out$dAICc[2]) {
      "type-II response"
    } else if (AIC.Out$dAICc[2] == 0 & (AIC.Out$dAICc[2] + 2) <= AIC.Out$dAICc[1]) {
      "type-III response"
    } else {
      "No evidence for any response."
    }
    Out.List.Inner[[j]] <- Output
    m <- m + 7; n <- n + 7
  }
  Out.List.Outer[[i]] <- Out.List.Inner
}})
Ex1.Prop <- c() 
for (i in 1:length(Ex1SimDat)){
  WE.II.III.NA <- c(length(which(Out.List.Outer[[i]] == "Warning or Error")),
                    length(which(Out.List.Outer[[i]] == "type-II response")),
                    length(which(Out.List.Outer[[i]] == "type-III response")),
                    length(which(Out.List.Outer[[i]] == "No evidence for any response.")))
  Ex1.Prop <- rbind(Ex1.Prop, WE.II.III.NA)
}
colnames(Ex1.Prop) <- c("Warning or Error", "II", "III", "No Evidence")
rownames(Ex1.Prop) <- c("TLow.II.Unif", "TLow.II.Norm",
                        "TMed.II.Unif", "TMed.II.Norm", "TMed.III.Unif", "TMed.III.Norm",
                        "THigh.II.Unif", "THigh.II.Norm", "THigh.III.Unif", "THigh.III.Norm")

## Experiment 2
N0 <- c(2, 3, 5, 10, 20, 30, 50)
Out.List.Outer <-  vector(mode = 'list', length = length(Ex2SimDat)) 
suppressWarnings({
for (i in 1:length(Ex2SimDat)){
  Out.List.Inner <-  vector(mode = 'list', length = 1000)
  m <- 1; n <- 7
  for (j in 1:1000){
    SimDat <- Ex2SimDat[[i]][m:n, ]
    Output.II <- tryCatch({frair_fit(Ne ~ N0, data = SimDat, response = 'rogersII',
                           start = list(a = 1, h = 0.1), fixed = list(T = 2))},
                          warning = function(w) {
                             cat("Warning: couldn't invert Hessian", conditionMessage(w), "\n")
                             "Couldn't invert Hessian"},
                          error = function(e) {
                            cat("Error in frfunc", conditionMessage(e), "\n")
                            "Couldn't evaluate function"})
    Output.III <- tryCatch({frair_fit(Ne ~ N0, data = SimDat, response = 'hassIIInr',
                            start = list(b = 1, c = 1, h = 0.1), fixed = list(T = 2))},
                           warning = function(w) {
                             cat("Warning: couldn't invert Hessian", conditionMessage(w), "\n")
                             "Couldn't invert Hessian"},
                           error = function(e) {
                             cat("Error in frfunc", conditionMessage(e), "\n")
                             "Couldn't evaluate function"})
    if (is.list(Output.II) & is.list(Output.III)) {
    AIC.Out <- ICtab(c(Output.II$fit, Output.III$fit), type = "AICc",
                     mnames = c("Output.II$fit", "Output.III$fit"), 
                     weights = TRUE, nobs = nrow(SimDat))}
    Output <- if (!is.list(Output.II) | !is.list(Output.III)) {
      "Warning or Error"
    } else if  (AIC.Out$dAICc[1] == 0 & (AIC.Out$dAICc[1] + 2) <= AIC.Out$dAICc[2]) {
      "type-II response"
    } else if (AIC.Out$dAICc[2] == 0 & (AIC.Out$dAICc[2] + 2) <= AIC.Out$dAICc[1]) {
      "type-III response"
    } else {
      "No evidence for any response."
    }
    Out.List.Inner[[j]] <- Output
    m <- m + 7; n <- n + 7
  }
  Out.List.Outer[[i]] <- Out.List.Inner
}})
Ex2.Prop <- c() 
for (i in 1:length(Ex2SimDat)){
  WE.II.III.NA <- c(length(which(Out.List.Outer[[i]] == "Warning or Error")),
                    length(which(Out.List.Outer[[i]] == "type-II response")),
                    length(which(Out.List.Outer[[i]] == "type-III response")),
                    length(which(Out.List.Outer[[i]] == "No evidence for any response.")))
  Ex2.Prop <- rbind(Ex2.Prop, WE.II.III.NA)
}
colnames(Ex2.Prop) <- c("Warning or Error", "II", "III", "No Evidence")
rownames(Ex2.Prop) <- c("TLow.II.Unif", "TLow.II.Norm",
                        "TMed.II.Unif", "TMed.II.Norm", "TMed.III.Unif", "TMed.III.Norm",
                        "THigh.II.Unif", "THigh.II.Norm", "THigh.III.Unif", "THigh.III.Norm")

## Experiment 3
N0 <- c(2, 3, 5, 10, 20, 30)
Out.List.Outer <-  vector(mode = 'list', length = length(Ex3SimDat)) 
suppressWarnings({
for (i in 1:length(Ex3SimDat)){
  Out.List.Inner <-  vector(mode = 'list', length = 1000)
  m <- 1; n <- 7
  for (j in 1:1000){
    SimDat <- Ex3SimDat[[i]][m:n, ]
    Output.II <- tryCatch({frair_fit(Ne ~ N0, data = SimDat, response = 'rogersII',
                           start = list(a = 1, h = 0.1), fixed = list(T = 2))},
                          warning = function(w) {
                             cat("Warning: couldn't invert Hessian", conditionMessage(w), "\n")
                             "Couldn't invert Hessian"},
                          error = function(e) {
                            cat("Error in frfunc", conditionMessage(e), "\n")
                            "Couldn't evaluate function"})
    Output.III <- tryCatch({frair_fit(Ne ~ N0, data = SimDat, response = 'hassIIInr',
                            start = list(b = 1, c = 1, h = 0.1), fixed = list(T = 2))},
                           warning = function(w) {
                             cat("Warning: couldn't invert Hessian", conditionMessage(w), "\n")
                             "Couldn't invert Hessian"},
                           error = function(e) {
                             cat("Error in frfunc", conditionMessage(e), "\n")
                             "Couldn't evaluate function"})
    if (is.list(Output.II) & is.list(Output.III)) {
    AIC.Out <- ICtab(c(Output.II$fit, Output.III$fit), type = "AICc",
                     mnames = c("Output.II$fit", "Output.III$fit"), 
                     weights = TRUE, nobs = nrow(SimDat))}
    Output <- if (!is.list(Output.II) | !is.list(Output.III)) {
      "Warning or Error"
    } else if  (AIC.Out$dAICc[1] == 0 & (AIC.Out$dAICc[1] + 2) <= AIC.Out$dAICc[2]) {
      "type-II response"
    } else if (AIC.Out$dAICc[2] == 0 & (AIC.Out$dAICc[2] + 2) <= AIC.Out$dAICc[1]) {
      "type-III response"
    } else {
      "No evidence for any response."
    }
    Out.List.Inner[[j]] <- Output
    m <- m + 7; n <- n + 7
  }
  Out.List.Outer[[i]] <- Out.List.Inner
}})
Ex3.Prop <- c() 
for (i in 1:length(Ex3SimDat)){
  WE.II.III.NA <- c(length(which(Out.List.Outer[[i]] == "Warning or Error")),
                    length(which(Out.List.Outer[[i]] == "type-II response")),
                    length(which(Out.List.Outer[[i]] == "type-III response")),
                    length(which(Out.List.Outer[[i]] == "No evidence for any response.")))
  Ex3.Prop <- rbind(Ex3.Prop, WE.II.III.NA)
}
colnames(Ex3.Prop) <- c("Warning or Error", "II", "III", "No Evidence")
rownames(Ex3.Prop) <- c("TRocks.II.Unif", "TRocks.II.Norm",
                        "TSand.II.Unif", "TSand.II.Norm", "TSand.III.Unif", "TSand.III.Norm")

## SAVING OUTPUTS
saveRDS(Ex1.Prop, here("./SimOutputs/Ex1Prop_AIC.rds"))
saveRDS(Ex2.Prop, here("./SimOutputs/Ex2Prop_AIC.rds"))
saveRDS(Ex3.Prop, here("./SimOutputs/Ex3Prop_AIC.rds"))
```

### Summarising Methods (1) Through (3)

```{r}
Ex1.Prop.J <- readRDS(here("./SimOutputs/Ex1Prop_Juliano.rds"))
Ex2.Prop.J <- readRDS(here("./SimOutputs/Ex2Prop_Juliano.rds"))
Ex3.Prop.J <- readRDS(here("./SimOutputs/Ex3Prop_Juliano.rds"))
Ex1.Prop.F <- readRDS(here("./SimOutputs/Ex1Prop_FlexFR.rds"))
Ex2.Prop.F <- readRDS(here("./SimOutputs/Ex2Prop_FlexFR.rds"))
Ex3.Prop.F <- readRDS(here("./SimOutputs/Ex3Prop_FlexFR.rds"))
Ex1.Prop.A <- readRDS(here("./SimOutputs/Ex1Prop_AIC.rds"))
Ex2.Prop.A <- readRDS(here("./SimOutputs/Ex2Prop_AIC.rds"))
Ex3.Prop.A <- readRDS(here("./SimOutputs/Ex3Prop_AIC.rds"))

Prop.List <- list(Ex1.Prop.J, Ex2.Prop.J, Ex3.Prop.J,
                  Ex1.Prop.F, Ex2.Prop.F, Ex3.Prop.F,
                  Ex1.Prop.A, Ex2.Prop.A, Ex3.Prop.A)

## Printing `runif` results to (1) look at outputs and (2) check that all the rows sum to 1000 (all simulations are accounted for)
for (i in 1:length(Prop.List)){
  rows <- seq(1, nrow(Prop.List[[i]]), 2)
  print(Prop.List[[i]][rows, ])
  # print(rowSums(Prop.List[[i]]))
}
```

### Method (4): Visual Inspection

#### Data Wrangling

```{r}
## Proportion DFs

# Experiment 1
Ex1.Low.II.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 7))
colnames(Ex1.Low.II.Unif.Props) <- c("N0.4", "N0.6", "N0.10", "N0.20", "N0.60", "N0.90", "N0.120")
j <- 1
for (i in 1:1000){
  Ex1.Low.II.Unif.Props[i, 1] <- Ex1SimDat[["TLow.II.Unif"]][j, 1]/4; j <- j + 1
  Ex1.Low.II.Unif.Props[i, 2] <- Ex1SimDat[["TLow.II.Unif"]][j, 1]/6; j <- j + 1
  Ex1.Low.II.Unif.Props[i, 3] <- Ex1SimDat[["TLow.II.Unif"]][j, 1]/10; j <- j + 1
  Ex1.Low.II.Unif.Props[i, 4] <- Ex1SimDat[["TLow.II.Unif"]][j, 1]/20; j <- j + 1
  Ex1.Low.II.Unif.Props[i, 5] <- Ex1SimDat[["TLow.II.Unif"]][j, 1]/60; j <- j + 1
  Ex1.Low.II.Unif.Props[i, 6] <- Ex1SimDat[["TLow.II.Unif"]][j, 1]/90; j <- j + 1
  Ex1.Low.II.Unif.Props[i, 7] <- Ex1SimDat[["TLow.II.Unif"]][j, 1]/120; j <- j + 1
}

Ex1.Med.II.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 7))
colnames(Ex1.Med.II.Unif.Props) <- c("N0.4", "N0.6", "N0.10", "N0.20", "N0.60", "N0.90", "N0.120")
j <- 1
for (i in 1:1000){
  Ex1.Med.II.Unif.Props[i, 1] <- Ex1SimDat[["TMed.II.Unif"]][j, 1]/4; j <- j + 1
  Ex1.Med.II.Unif.Props[i, 2] <- Ex1SimDat[["TMed.II.Unif"]][j, 1]/6; j <- j + 1
  Ex1.Med.II.Unif.Props[i, 3] <- Ex1SimDat[["TMed.II.Unif"]][j, 1]/10; j <- j + 1
  Ex1.Med.II.Unif.Props[i, 4] <- Ex1SimDat[["TMed.II.Unif"]][j, 1]/20; j <- j + 1
  Ex1.Med.II.Unif.Props[i, 5] <- Ex1SimDat[["TMed.II.Unif"]][j, 1]/60; j <- j + 1
  Ex1.Med.II.Unif.Props[i, 6] <- Ex1SimDat[["TMed.II.Unif"]][j, 1]/90; j <- j + 1
  Ex1.Med.II.Unif.Props[i, 7] <- Ex1SimDat[["TMed.II.Unif"]][j, 1]/120; j <- j + 1
}

Ex1.Med.III.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 7))
colnames(Ex1.Med.III.Unif.Props) <- c("N0.4", "N0.6", "N0.10", "N0.20", "N0.60", "N0.90", "N0.120")
j <- 1
for (i in 1:1000){
  Ex1.Med.III.Unif.Props[i, 1] <- Ex1SimDat[["TMed.III.Unif"]][j, 1]/4; j <- j + 1
  Ex1.Med.III.Unif.Props[i, 2] <- Ex1SimDat[["TMed.III.Unif"]][j, 1]/6; j <- j + 1
  Ex1.Med.III.Unif.Props[i, 3] <- Ex1SimDat[["TMed.III.Unif"]][j, 1]/10; j <- j + 1
  Ex1.Med.III.Unif.Props[i, 4] <- Ex1SimDat[["TMed.III.Unif"]][j, 1]/20; j <- j + 1
  Ex1.Med.III.Unif.Props[i, 5] <- Ex1SimDat[["TMed.III.Unif"]][j, 1]/60; j <- j + 1
  Ex1.Med.III.Unif.Props[i, 6] <- Ex1SimDat[["TMed.III.Unif"]][j, 1]/90; j <- j + 1
  Ex1.Med.III.Unif.Props[i, 7] <- Ex1SimDat[["TMed.III.Unif"]][j, 1]/120; j <- j + 1
}

Ex1.High.II.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 7))
colnames(Ex1.High.II.Unif.Props) <- c("N0.4", "N0.6", "N0.10", "N0.20", "N0.60", "N0.90", "N0.120")
j <- 1
for (i in 1:1000){
  Ex1.High.II.Unif.Props[i, 1] <- Ex1SimDat[["THigh.II.Unif"]][j, 1]/4; j <- j + 1
  Ex1.High.II.Unif.Props[i, 2] <- Ex1SimDat[["THigh.II.Unif"]][j, 1]/6; j <- j + 1
  Ex1.High.II.Unif.Props[i, 3] <- Ex1SimDat[["THigh.II.Unif"]][j, 1]/10; j <- j + 1
  Ex1.High.II.Unif.Props[i, 4] <- Ex1SimDat[["THigh.II.Unif"]][j, 1]/20; j <- j + 1
  Ex1.High.II.Unif.Props[i, 5] <- Ex1SimDat[["THigh.II.Unif"]][j, 1]/60; j <- j + 1
  Ex1.High.II.Unif.Props[i, 6] <- Ex1SimDat[["THigh.II.Unif"]][j, 1]/90; j <- j + 1
  Ex1.High.II.Unif.Props[i, 7] <- Ex1SimDat[["THigh.II.Unif"]][j, 1]/120; j <- j + 1
}

Ex1.High.III.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 7))
colnames(Ex1.High.III.Unif.Props) <- c("N0.4", "N0.6", "N0.10", "N0.20", "N0.60", "N0.90", "N0.120")
j <- 1
for (i in 1:1000){
  Ex1.High.III.Unif.Props[i, 1] <- Ex1SimDat[["THigh.III.Unif"]][j, 1]/4; j <- j + 1
  Ex1.High.III.Unif.Props[i, 2] <- Ex1SimDat[["THigh.III.Unif"]][j, 1]/6; j <- j + 1
  Ex1.High.III.Unif.Props[i, 3] <- Ex1SimDat[["THigh.III.Unif"]][j, 1]/10; j <- j + 1
  Ex1.High.III.Unif.Props[i, 4] <- Ex1SimDat[["THigh.III.Unif"]][j, 1]/20; j <- j + 1
  Ex1.High.III.Unif.Props[i, 5] <- Ex1SimDat[["THigh.III.Unif"]][j, 1]/60; j <- j + 1
  Ex1.High.III.Unif.Props[i, 6] <- Ex1SimDat[["THigh.III.Unif"]][j, 1]/90; j <- j + 1
  Ex1.High.III.Unif.Props[i, 7] <- Ex1SimDat[["THigh.III.Unif"]][j, 1]/120; j <- j + 1
}

# Experiment 2 # 2, 3, 5, 10, 20, 30, 50
Ex2.Low.II.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 7))
colnames(Ex2.Low.II.Unif.Props) <- c("N0.2", "N0.3", "N0.5", "N0.10", "N0.20", "N0.30", "N0.50")
j <- 1
for (i in 1:1000){
  Ex2.Low.II.Unif.Props[i, 1] <- Ex2SimDat[["TLow.II.Unif"]][j, 1]/2; j <- j + 1
  Ex2.Low.II.Unif.Props[i, 2] <- Ex2SimDat[["TLow.II.Unif"]][j, 1]/3; j <- j + 1
  Ex2.Low.II.Unif.Props[i, 3] <- Ex2SimDat[["TLow.II.Unif"]][j, 1]/5; j <- j + 1
  Ex2.Low.II.Unif.Props[i, 4] <- Ex2SimDat[["TLow.II.Unif"]][j, 1]/10; j <- j + 1
  Ex2.Low.II.Unif.Props[i, 5] <- Ex2SimDat[["TLow.II.Unif"]][j, 1]/20; j <- j + 1
  Ex2.Low.II.Unif.Props[i, 6] <- Ex2SimDat[["TLow.II.Unif"]][j, 1]/30; j <- j + 1
  Ex2.Low.II.Unif.Props[i, 7] <- Ex2SimDat[["TLow.II.Unif"]][j, 1]/50; j <- j + 1
}

Ex2.Low.III.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 7))
colnames(Ex2.Low.III.Unif.Props) <- c("N0.2", "N0.3", "N0.5", "N0.10", "N0.20", "N0.30", "N0.50")
j <- 1
for (i in 1:1000){
  Ex2.Low.III.Unif.Props[i, 1] <- Ex2SimDat[["TLow.III.Unif"]][j, 1]/2; j <- j + 1
  Ex2.Low.III.Unif.Props[i, 2] <- Ex2SimDat[["TLow.III.Unif"]][j, 1]/3; j <- j + 1
  Ex2.Low.III.Unif.Props[i, 3] <- Ex2SimDat[["TLow.III.Unif"]][j, 1]/5; j <- j + 1
  Ex2.Low.III.Unif.Props[i, 4] <- Ex2SimDat[["TLow.III.Unif"]][j, 1]/10; j <- j + 1
  Ex2.Low.III.Unif.Props[i, 5] <- Ex2SimDat[["TLow.III.Unif"]][j, 1]/20; j <- j + 1
  Ex2.Low.III.Unif.Props[i, 6] <- Ex2SimDat[["TLow.III.Unif"]][j, 1]/30; j <- j + 1
  Ex2.Low.III.Unif.Props[i, 7] <- Ex2SimDat[["TLow.III.Unif"]][j, 1]/50; j <- j + 1
}

Ex2.Med.III.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 7))
colnames(Ex2.Med.III.Unif.Props) <- c("N0.2", "N0.3", "N0.5", "N0.10", "N0.20", "N0.30", "N0.50")
j <- 1
for (i in 1:1000){
  Ex2.Med.III.Unif.Props[i, 1] <- Ex2SimDat[["TMed.III.Unif"]][j, 1]/2; j <- j + 1
  Ex2.Med.III.Unif.Props[i, 2] <- Ex2SimDat[["TMed.III.Unif"]][j, 1]/3; j <- j + 1
  Ex2.Med.III.Unif.Props[i, 3] <- Ex2SimDat[["TMed.III.Unif"]][j, 1]/5; j <- j + 1
  Ex2.Med.III.Unif.Props[i, 4] <- Ex2SimDat[["TMed.III.Unif"]][j, 1]/10; j <- j + 1
  Ex2.Med.III.Unif.Props[i, 5] <- Ex2SimDat[["TMed.III.Unif"]][j, 1]/20; j <- j + 1
  Ex2.Med.III.Unif.Props[i, 6] <- Ex2SimDat[["TMed.III.Unif"]][j, 1]/30; j <- j + 1
  Ex2.Med.III.Unif.Props[i, 7] <- Ex2SimDat[["TMed.III.Unif"]][j, 1]/50; j <- j + 1
}

Ex2.High.II.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 7))
colnames(Ex2.High.II.Unif.Props) <- c("N0.2", "N0.3", "N0.5", "N0.10", "N0.20", "N0.30", "N0.50")
j <- 1
for (i in 1:1000){
  Ex2.High.II.Unif.Props[i, 1] <- Ex2SimDat[["THigh.II.Unif"]][j, 1]/2; j <- j + 1
  Ex2.High.II.Unif.Props[i, 2] <- Ex2SimDat[["THigh.II.Unif"]][j, 1]/3; j <- j + 1
  Ex2.High.II.Unif.Props[i, 3] <- Ex2SimDat[["THigh.II.Unif"]][j, 1]/5; j <- j + 1
  Ex2.High.II.Unif.Props[i, 4] <- Ex2SimDat[["THigh.II.Unif"]][j, 1]/10; j <- j + 1
  Ex2.High.II.Unif.Props[i, 5] <- Ex2SimDat[["THigh.II.Unif"]][j, 1]/20; j <- j + 1
  Ex2.High.II.Unif.Props[i, 6] <- Ex2SimDat[["THigh.II.Unif"]][j, 1]/30; j <- j + 1
  Ex2.High.II.Unif.Props[i, 7] <- Ex2SimDat[["THigh.II.Unif"]][j, 1]/50; j <- j + 1
}

Ex2.High.III.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 7))
colnames(Ex2.High.III.Unif.Props) <- c("N0.2", "N0.3", "N0.5", "N0.10", "N0.20", "N0.30", "N0.50")
j <- 1
for (i in 1:1000){
  Ex2.High.III.Unif.Props[i, 1] <- Ex2SimDat[["THigh.III.Unif"]][j, 1]/2; j <- j + 1
  Ex2.High.III.Unif.Props[i, 2] <- Ex2SimDat[["THigh.III.Unif"]][j, 1]/3; j <- j + 1
  Ex2.High.III.Unif.Props[i, 3] <- Ex2SimDat[["THigh.III.Unif"]][j, 1]/5; j <- j + 1
  Ex2.High.III.Unif.Props[i, 4] <- Ex2SimDat[["THigh.III.Unif"]][j, 1]/10; j <- j + 1
  Ex2.High.III.Unif.Props[i, 5] <- Ex2SimDat[["THigh.III.Unif"]][j, 1]/20; j <- j + 1
  Ex2.High.III.Unif.Props[i, 6] <- Ex2SimDat[["THigh.III.Unif"]][j, 1]/30; j <- j + 1
  Ex2.High.III.Unif.Props[i, 7] <- Ex2SimDat[["THigh.III.Unif"]][j, 1]/50; j <- j + 1
}

# Experiment 3
Ex3.Rocks.II.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 6))
colnames(Ex3.Rocks.II.Unif.Props) <- c("N0.2", "N0.3", "N0.5", "N0.10", "N0.20", "N0.30")
j <- 1
for (i in 1:1000){
  Ex3.Rocks.II.Unif.Props[i, 1] <- Ex3SimDat[["TRocks.II.Unif"]][j, 1]/2; j <- j + 1
  Ex3.Rocks.II.Unif.Props[i, 2] <- Ex3SimDat[["TRocks.II.Unif"]][j, 1]/3; j <- j + 1
  Ex3.Rocks.II.Unif.Props[i, 3] <- Ex3SimDat[["TRocks.II.Unif"]][j, 1]/5; j <- j + 1
  Ex3.Rocks.II.Unif.Props[i, 4] <- Ex3SimDat[["TRocks.II.Unif"]][j, 1]/10; j <- j + 1
  Ex3.Rocks.II.Unif.Props[i, 5] <- Ex3SimDat[["TRocks.II.Unif"]][j, 1]/20; j <- j + 1
  Ex3.Rocks.II.Unif.Props[i, 6] <- Ex3SimDat[["TRocks.II.Unif"]][j, 1]/30; j <- j + 1
}

Ex3.Sand.II.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 6))
colnames(Ex3.Sand.II.Unif.Props) <- c("N0.2", "N0.3", "N0.5", "N0.10", "N0.20", "N0.30")
j <- 1
for (i in 1:1000){
  Ex3.Sand.II.Unif.Props[i, 1] <- Ex3SimDat[["TSand.II.Unif"]][j, 1]/2; j <- j + 1
  Ex3.Sand.II.Unif.Props[i, 2] <- Ex3SimDat[["TSand.II.Unif"]][j, 1]/3; j <- j + 1
  Ex3.Sand.II.Unif.Props[i, 3] <- Ex3SimDat[["TSand.II.Unif"]][j, 1]/5; j <- j + 1
  Ex3.Sand.II.Unif.Props[i, 4] <- Ex3SimDat[["TSand.II.Unif"]][j, 1]/10; j <- j + 1
  Ex3.Sand.II.Unif.Props[i, 5] <- Ex3SimDat[["TSand.II.Unif"]][j, 1]/20; j <- j + 1
  Ex3.Sand.II.Unif.Props[i, 6] <- Ex3SimDat[["TSand.II.Unif"]][j, 1]/30; j <- j + 1
}

Ex3.Sand.III.Unif.Props <- data.frame(matrix(NA, nrow = 1000, ncol = 6))
colnames(Ex3.Sand.III.Unif.Props) <- c("N0.2", "N0.3", "N0.5", "N0.10", "N0.20", "N0.30")
j <- 1
for (i in 1:1000){
  Ex3.Sand.III.Unif.Props[i, 1] <- Ex3SimDat[["TSand.III.Unif"]][j, 1]/2; j <- j + 1
  Ex3.Sand.III.Unif.Props[i, 2] <- Ex3SimDat[["TSand.III.Unif"]][j, 1]/3; j <- j + 1
  Ex3.Sand.III.Unif.Props[i, 3] <- Ex3SimDat[["TSand.III.Unif"]][j, 1]/5; j <- j + 1
  Ex3.Sand.III.Unif.Props[i, 4] <- Ex3SimDat[["TSand.III.Unif"]][j, 1]/10; j <- j + 1
  Ex3.Sand.III.Unif.Props[i, 5] <- Ex3SimDat[["TSand.III.Unif"]][j, 1]/20; j <- j + 1
  Ex3.Sand.III.Unif.Props[i, 6] <- Ex3SimDat[["TSand.III.Unif"]][j, 1]/30; j <- j + 1
}
```

#### Lowess Smoothing (20 Groups of 50 Simulations)

```{r}
colours <- c("#A51E1C", "#DABF40", "#97FD34", "#6215C9", "#EB1B41", 
             "#91BB7F", "#7F6062", "#DE31C2", "#4F799E", "#4DC669", 
             "#006244", "#8803E7", "#EEA4F4", "#1C23A2", "#EF7C3A", 
             "#B74C83", "#53B5E5", "#B3AFDC", "#30525B", "#021D45")
j <- c(1, 51, 101, 151, 201, 251, 301, 351, 401, 451,
       501, 551, 601, 651, 701, 751, 801, 851, 901, 951)
  
## Experiment 1
N0s <- c(4, 6, 10, 20, 60, 90, 120); N0sRep <- rep(N0s, each = 50) 
# Low, II
Ex1.LowII.Lowess <- vector(mode = "list", length = 10)
for (i in 1:20){
  Props <- c(Ex1.Low.II.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex1.Low.II.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex1.Low.II.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex1.Low.II.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex1.Low.II.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex1.Low.II.Unif.Props[j[i]:(j[i] + 49), 6], 
             Ex1.Low.II.Unif.Props[j[i]:(j[i] + 49), 7])
  # Ex1.LowII.Lowess[[i]] <- lowess(N0sRep, Props, f = 7/7, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex1.LowII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 120), ylim = c(0, 1), 
     main = "Ex1.LowII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex1.LowII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex1_LowII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex1.LowII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 120), ylim = c(0, 1), 
       main = "Ex1.LowII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()
# Med., II
Ex1.MedII.Lowess <- vector(mode = "list", length = 20)
for (i in 1:20){
  Props <- c(Ex1.Med.II.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex1.Med.II.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex1.Med.II.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex1.Med.II.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex1.Med.II.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex1.Med.II.Unif.Props[j[i]:(j[i] + 49), 6], 
             Ex1.Med.II.Unif.Props[j[i]:(j[i] + 49), 7])
  # Ex1.MedII.Lowess[[i]] <- lowess(N0sRep, Props, f = 7/7, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex1.MedII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 120), ylim = c(0, 1), 
     main = "Ex1.MedII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex1.MedII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex1_MedII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex1.MedII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 120), ylim = c(0, 1), 
       main = "Ex1.MedII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()
# Med., III
Ex1.MedIII.Lowess <- vector(mode = "list", length = 20)
for (i in 1:20){
  Props <- c(Ex1.Med.III.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex1.Med.III.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex1.Med.III.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex1.Med.III.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex1.Med.III.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex1.Med.III.Unif.Props[j[i]:(j[i] + 49), 6], 
             Ex1.Med.III.Unif.Props[j[i]:(j[i] + 49), 7])
  # Ex1.MedIII.Lowess[[i]] <- lowess(N0sRep, Props, f = 7/7, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex1.MedIII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 120), ylim = c(0, 1), 
     main = "Ex1.MedIII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex1.MedIII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex1_MedIII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex1.MedIII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 120), ylim = c(0, 1), 
       main = "Ex1.MedIII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()
# High, II
Ex1.HighII.Lowess <- vector(mode = "list", length = 20)
for (i in 1:20){
  Props <- c(Ex1.High.II.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex1.High.II.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex1.High.II.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex1.High.II.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex1.High.II.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex1.High.II.Unif.Props[j[i]:(j[i] + 49), 6], 
             Ex1.High.II.Unif.Props[j[i]:(j[i] + 49), 7])
  # Ex1.HighII.Lowess[[i]] <- lowess(N0sRep, Props, f = 7/7, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex1.HighII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 120), ylim = c(0, 1), 
     main = "Ex1.HighII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex1.HighII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex1_HighII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex1.HighII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 120), ylim = c(0, 1), 
       main = "Ex1.HighII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()
# High, III
Ex1.HighIII.Lowess <- vector(mode = "list", length = 20)
for (i in 1:20){
  Props <- c(Ex1.High.III.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex1.High.III.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex1.High.III.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex1.High.III.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex1.High.III.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex1.High.III.Unif.Props[j[i]:(j[i] + 49), 6], 
             Ex1.High.III.Unif.Props[j[i]:(j[i] + 49), 7])
  # Ex1.HighIII.Lowess[[i]] <- lowess(N0sRep, Props, f = 7/7, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex1.HighIII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 120), ylim = c(0, 1), 
     main = "Ex1.HighIII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex1.HighIII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex1_HighIII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex1.HighIII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 120), ylim = c(0, 1), 
       main = "Ex1.HighIII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()

## Experiment 2
N0s <- c(2, 3, 5, 10, 20, 30, 50); N0sRep <- rep(N0s, each = 50)
# Low, II
Ex2.LowII.Lowess <- vector(mode = "list", length = 20)
for (i in 1:20){
  Props <- c(Ex2.Low.II.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex2.Low.II.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex2.Low.II.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex2.Low.II.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex2.Low.II.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex2.Low.II.Unif.Props[j[i]:(j[i] + 49), 6], 
             Ex2.Low.II.Unif.Props[j[i]:(j[i] + 49), 7])
  # Ex2.LowII.Lowess[[i]] <- lowess(N0sRep, Props, f = 7/7, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex2.LowII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 50), ylim = c(0, 1), 
     main = "Ex2.LowII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex2.LowII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex2_LowII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex2.LowII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 50), ylim = c(0, 1), 
       main = "Ex2.LowII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()
# Low, III
Ex2.LowIII.Lowess <- vector(mode = "list", length = 20)
for (i in 1:20){
  Props <- c(Ex2.Low.III.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex2.Low.III.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex2.Low.III.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex2.Low.III.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex2.Low.III.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex2.Low.III.Unif.Props[j[i]:(j[i] + 49), 6], 
             Ex2.Low.III.Unif.Props[j[i]:(j[i] + 49), 7])
  # Ex2.LowIII.Lowess[[i]] <- lowess(N0sRep, Props, f = 7/7, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex2.LowIII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 50), ylim = c(0, 1), 
     main = "Ex2.LowIII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex2.LowIII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex2_LowIII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex2.LowIII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 50), ylim = c(0, 1), 
       main = "Ex2.LowIII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()
# Med., III
Ex2.MedIII.Lowess <- vector(mode = "list", length = 20)
for (i in 1:20){
  Props <- c(Ex2.Med.III.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex2.Med.III.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex2.Med.III.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex2.Med.III.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex2.Med.III.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex2.Med.III.Unif.Props[j[i]:(j[i] + 49), 6], 
             Ex2.Med.III.Unif.Props[j[i]:(j[i] + 49), 7])
  # Ex2.MedIII.Lowess[[i]] <- lowess(N0sRep, Props, f = 7/7, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex2.MedIII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 50), ylim = c(0, 1), 
     main = "Ex2.MedIII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex2.MedIII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex2_MedIII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex2.MedIII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 50), ylim = c(0, 1), 
       main = "Ex2.MedIII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()
# High, II
Ex2.HighII.Lowess <- vector(mode = "list", length = 20)
for (i in 1:20){
  Props <- c(Ex2.High.II.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex2.High.II.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex2.High.II.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex2.High.II.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex2.High.II.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex2.High.II.Unif.Props[j[i]:(j[i] + 49), 6], 
             Ex2.High.II.Unif.Props[j[i]:(j[i] + 49), 7])
  # Ex2.HighII.Lowess[[i]] <- lowess(N0sRep, Props, f = 7/7, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex2.HighII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 50), ylim = c(0, 1), 
     main = "Ex2.HighII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex2.HighII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex2_HighII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex2.HighII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 50), ylim = c(0, 1), 
       main = "Ex2.HighII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()
# High, III
Ex2.HighIII.Lowess <- vector(mode = "list", length = 20)
for (i in 1:20){
  Props <- c(Ex2.High.III.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex2.High.III.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex2.High.III.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex2.High.III.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex2.High.III.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex2.High.III.Unif.Props[j[i]:(j[i] + 49), 6], 
             Ex2.High.III.Unif.Props[j[i]:(j[i] + 49), 7])
  # Ex2.HighIII.Lowess[[i]] <- lowess(N0sRep, Props, f = 7/7, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex2.HighIII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 50), ylim = c(0, 1), 
     main = "Ex2.HighIII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex2.HighIII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex2_HighIII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex2.HighIII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 50), ylim = c(0, 1), 
       main = "Ex2.HighIII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()

# Experiment 3
N0s <- c(2, 3, 5, 10, 20, 30); N0sRep <- rep(N0s, each = 50)
# Rocks, II
Ex3.RocksII.Lowess <- vector(mode = "list", length = 20)
for (i in 1:20){
  Props <- c(Ex3.Rocks.II.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex3.Rocks.II.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex3.Rocks.II.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex3.Rocks.II.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex3.Rocks.II.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex3.Rocks.II.Unif.Props[j[i]:(j[i] + 49), 6])
  # Ex3.RocksII.Lowess[[i]] <- lowess(N0sRep, Props, f = 6/6, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex3.RocksII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 30), ylim = c(0, 1), 
     main = "Ex3.RocksII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex3.RocksII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex3_RocksII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex3.RocksII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 30), ylim = c(0, 1), 
       main = "Ex3.RocksII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()
# Sand, II
Ex3.SandII.Lowess <- vector(mode = "list", length = 20)
for (i in 1:20){
  Props <- c(Ex3.Sand.II.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex3.Sand.II.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex3.Sand.II.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex3.Sand.II.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex3.Sand.II.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex3.Sand.II.Unif.Props[j[i]:(j[i] + 49), 6])
  # Ex3.SandII.Lowess[[i]] <- lowess(N0sRep, Props, f = 6/6, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex3.SandII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 30), ylim = c(0, 1), 
     main = "Ex3.SandII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex3.SandII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex3_SandII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex3.SandII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 30), ylim = c(0, 1), 
       main = "Ex3.SandII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()
# Sand, III
Ex3.SandIII.Lowess <- vector(mode = "list", length = 20)
for (i in 1:20){
  Props <- c(Ex3.Sand.III.Unif.Props[j[i]:(j[i] + 49), 1],
             Ex3.Sand.III.Unif.Props[j[i]:(j[i] + 49), 2], 
             Ex3.Sand.III.Unif.Props[j[i]:(j[i] + 49), 3], 
             Ex3.Sand.III.Unif.Props[j[i]:(j[i] + 49), 4],
             Ex3.Sand.III.Unif.Props[j[i]:(j[i] + 49), 5], 
             Ex3.Sand.III.Unif.Props[j[i]:(j[i] + 49), 6])
  # Ex3.SandIII.Lowess[[i]] <- lowess(N0sRep, Props, f = 6/6, iter = 3, delta = 0.01 * diff(range(N0sRep)))
  Ex3.SandIII.Lowess[[i]] <- lowess(N0sRep, Props)
}
par(mfrow = c(1, 1))
plot(1, type = "n", xlim = c(0, 30), ylim = c(0, 1), 
     main = "Ex3.SandIII.Lowess", ylab = "Proportion", xlab = "Initial Density")
for (i in 1:20){
  lines(Ex3.SandIII.Lowess[[i]], col = colours[i])
}
png(file = here("./SimOutputs/Plots/Ex3_SandIII_Lowess.png"), width = 1800, height = 900)
par(mfrow = c(4, 5))
for (i in 1:20){
  plot(Ex3.SandIII.Lowess[[i]], col = colours[i], type = "l", xlim = c(0, 30), ylim = c(0, 1), 
       main = "Ex3.SandIII.Lowess", ylab = "Proportion", xlab = "Initial Density")
}
dev.off()
```

#### Summary

Experiment 1

-   Low, II: 20/20 Correct

-   Med., II: 20/20 Correct

-   Med., III: 0/20 Correct

-   High, II: 20/20 Correct

-   High, III, 0/20 Correct

Experiment 2

-   Low, II: 18/20 Correct

-   Low, III: 5/20 Correct

-   Med., III: 20/20 Correct

-   High, II: 18/20 Correct

-   High, III, 20/20 Correct

Experiment 3

-   Rocks, II: 17/20 Correct

-   Sand, II: 20/20 Correct

-   Sand, III: 0/20 Correct
